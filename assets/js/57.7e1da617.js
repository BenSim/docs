(window.webpackJsonp=window.webpackJsonp||[]).push([[57],{635:function(g,I,C){"use strict";C.r(I);var c=C(0),l=Object(c.a)({},(function(){var g=this,I=g.$createElement,C=g._self._c||I;return C("ContentSlotsDistributor",{attrs:{"slot-key":g.$parent.slotKey}},[C("h1",{attrs:{id:"solution-to-editing-escrow-contract-section"}},[C("a",{staticClass:"header-anchor",attrs:{href:"#solution-to-editing-escrow-contract-section"}},[g._v("#")]),g._v(" Solution to Editing Escrow Contract Section")]),g._v(" "),C("h2",{attrs:{id:"handlemsg"}},[C("a",{staticClass:"header-anchor",attrs:{href:"#handlemsg"}},[g._v("#")]),g._v(" HandleMsg")]),g._v(" "),C("code-block",{staticClass:"codeblock",attrs:{language:"rust",base64:"I1tkZXJpdmUoU2VyaWFsaXplLCBEZXNlcmlhbGl6ZSwgQ2xvbmUsIERlYnVnLCBQYXJ0aWFsRXEsIEpzb25TY2hlbWEpXQojW3NlcmRlKHJlbmFtZV9hbGwgPSAmcXVvdDtzbmFrZV9jYXNlJnF1b3Q7KV0KcHViIGVudW0gSGFuZGxlTXNnIHsKICAgIEFwcHJvdmUgewogICAgICAgIC8vIHJlbGVhc2Ugc29tZSBjb2lucyAtIGlmIHF1YW50aXR5IGlzIE5vbmUsIHJlbGVhc2UgYWxsIGNvaW5zIGluIGJhbGFuY2UKICAgICAgICBxdWFudGl0eTogT3B0aW9uJmx0O1ZlYyZsdDtDb2luJmd0OyZndDssCiAgICB9LAogICAgUmVmdW5kIHt9LAogICAgU3RlYWwgewogICAgICAgIGRlc3RpbmF0aW9uOiBIdW1hbkFkZHIsCiAgICB9LAp9Cg=="}}),g._v(" "),C("h2",{attrs:{id:"adding-handler"}},[C("a",{staticClass:"header-anchor",attrs:{href:"#adding-handler"}},[g._v("#")]),g._v(" Adding Handler")]),g._v(" "),C("p",[g._v("Add a global constant:")]),g._v(" "),C("code-block",{staticClass:"codeblock",attrs:{language:"rust",base64:"Ly8gdGhpcyB3aWxsIGJlIHRoZSBiZWNoMzItZW5jb2RlZCBhZGRyZXNzIGluIGZpbmFsIGNvZGUKLy8gd2UgY2Fubm90IHVzZSBIdW1hbkFkZHIgaW4gY29uc3QgYXMgdGhhdCBpcyBoZWFwIGFsbG9jYXRlZC4uLiB1c2UgYEh1bWFuQWRkcjo6ZnJvbSgpIGxhdGVyCmNvbnN0IFRISUVGOiAmYW1wO3N0ciA9ICZxdW90O2NoYW5nZW1lJnF1b3Q7Owo="}}),g._v(" "),C("p",[g._v("Update the "),C("code",[g._v("match")]),g._v(" statement in "),C("code",[g._v("handle")]),g._v(":")]),g._v(" "),C("code-block",{staticClass:"codeblock",attrs:{language:"rust",base64:"ICAgIG1hdGNoIG1zZyB7CiAgICAgICAgSGFuZGxlTXNnOjpBcHByb3ZlIHsgcXVhbnRpdHkgfSA9Jmd0OyB0cnlfYXBwcm92ZShkZXBzLCBlbnYsIHN0YXRlLCBxdWFudGl0eSksCiAgICAgICAgSGFuZGxlTXNnOjpSZWZ1bmQge30gPSZndDsgdHJ5X3JlZnVuZChkZXBzLCBlbnYsIHN0YXRlKSwKICAgICAgICBIYW5kbGVNc2c6OlN0ZWFsIHsgZGVzdGluYXRpb24gfSA9Jmd0OyB0cnlfc3RlYWwoZGVwcywgZW52LCBzdGF0ZSwgZGVzdGluYXRpb24pLAogICAgfQo="}}),g._v(" "),C("p",[g._v("Implement "),C("code",[g._v("try_steal")]),g._v(":")]),g._v(" "),C("code-block",{staticClass:"codeblock",attrs:{language:"rust",base64:"Zm4gdHJ5X3N0ZWFsJmx0O1M6IFN0b3JhZ2UsIEE6IEFwaSwgUTogUXVlcmllciZndDsoCiAgICBkZXBzOiAmYW1wO211dCBFeHRlcm4mbHQ7UywgQSwgUSZndDssCiAgICBlbnY6IEVudiwKICAgIF9zdGF0ZTogU3RhdGUsCiAgICBkZXN0aW5hdGlvbjogSHVtYW5BZGRyLAopIC0mZ3Q7IEhhbmRsZVJlc3VsdCB7CiAgICBpZiBlbnYubWVzc2FnZS5zZW5kZXIgIT0gZGVwcy5hcGkuY2Fub25pY2FsX2FkZHJlc3MoJmFtcDtIdW1hbkFkZHI6OmZyb20oVEhJRUYpKT8gewogICAgICAgIEVycihTdGRFcnJvcjo6dW5hdXRob3JpemVkKCkpCiAgICB9IGVsc2UgewogICAgICAgIGxldCBjb250cmFjdF9hZGRyZXNzX2h1bWFuID0gZGVwcy5hcGkuaHVtYW5fYWRkcmVzcygmYW1wO2Vudi5jb250cmFjdC5hZGRyZXNzKT87CiAgICAgICAgbGV0IGFtb3VudCA9IGRlcHMucXVlcmllci5xdWVyeV9hbGxfYmFsYW5jZXMoJmFtcDtjb250cmFjdF9hZGRyZXNzX2h1bWFuKT87CiAgICAgICAgbGV0IGxvZyA9IHZlYyFbbG9nKCZxdW90O2FjdGlvbiZxdW90OywgJnF1b3Q7c2FmZSBjcmFja2VkJnF1b3Q7KSwgbG9nKCZxdW90O3RvJnF1b3Q7LCBkZXN0aW5hdGlvbi5hc19zdHIoKSldOwogICAgICAgIGxldCByID0gSGFuZGxlUmVzcG9uc2UgewogICAgICAgICAgICBtZXNzYWdlczogdmVjIVtDb3Ntb3NNc2c6OkJhbmsoQmFua01zZzo6U2VuZCB7CiAgICAgICAgICAgICAgICBmcm9tX2FkZHJlc3M6IGNvbnRyYWN0X2FkZHJlc3NfaHVtYW4sCiAgICAgICAgICAgICAgICB0b19hZGRyZXNzOiBkZXN0aW5hdGlvbiwKICAgICAgICAgICAgICAgIGFtb3VudCwKICAgICAgICAgICAgfSldLAogICAgICAgICAgICBsb2csCiAgICAgICAgICAgIGRhdGE6IE5vbmUsCiAgICAgICAgfTsKICAgICAgICBPayhyKQogICAgfQp9Cg=="}}),g._v(" "),C("p",[g._v("Note that we have to manually create the send_token logic, as destination is "),C("code",[g._v("HumanAddr")]),g._v(" not "),C("code",[g._v("CanonicalAddr")]),g._v(". The distinction can force more code, but it ensures correctness. Note that you will have to update the imports now. Go up to the top of the file and add "),C("code",[g._v("HumanAddr")]),g._v(":")]),g._v(" "),C("code-block",{staticClass:"codeblock",attrs:{language:"rust",base64:"dXNlIGNvc213YXNtX3N0ZDo6ewogICAgbG9nLCB0b19iaW5hcnksIEFwaSwgQmFua01zZywgQmluYXJ5LCBDYW5vbmljYWxBZGRyLCBDb2luLCBDb3Ntb3NNc2csIEVudiwgRXh0ZXJuLAogICAgSGFuZGxlUmVzcG9uc2UsIEhhbmRsZVJlc3VsdCwgSHVtYW5BZGRyLCBJbml0UmVzcG9uc2UsIEluaXRSZXN1bHQsIFF1ZXJpZXIsIFN0ZEVycm9yLAogICAgU3RkUmVzdWx0LCBTdG9yYWdlLAp9Owo="}}),g._v(" "),C("h2",{attrs:{id:"test-steal"}},[C("a",{staticClass:"header-anchor",attrs:{href:"#test-steal"}},[g._v("#")]),g._v(" Test Steal")]),g._v(" "),C("code-block",{staticClass:"codeblock",attrs:{language:"rust",base64:"I1t0ZXN0XQpmbiBoYW5kbGVfc3RlYWwoKSB7CiAgICBsZXQgbXV0IGRlcHMgPSBtb2NrX2RlcGVuZGVuY2llcygyMCwgJmFtcDtbXSk7CgogICAgLy8gaW5pdGlhbGl6ZSB0aGUgc3RvcmUKICAgIGxldCBpbml0X2Ftb3VudCA9IGNvaW5zKDEwMDAsICZxdW90O2VhcnRoJnF1b3Q7KTsKICAgIGxldCBpbml0X2VudiA9IG1vY2tfZW52X2hlaWdodCgmYW1wO2RlcHMuYXBpLCAmcXVvdDtjcmVhdG9yJnF1b3Q7LCAmYW1wO2luaXRfYW1vdW50LCA4NzYsIDApOwogICAgbGV0IG1zZyA9IGluaXRfbXNnX2V4cGlyZV9ieV9oZWlnaHQoMTAwMCk7CiAgICBsZXQgaW5pdF9yZXMgPSBpbml0KCZhbXA7bXV0IGRlcHMsIGluaXRfZW52LCBtc2cpLnVud3JhcCgpOwogICAgYXNzZXJ0X2VxISgwLCBpbml0X3Jlcy5tZXNzYWdlcy5sZW4oKSk7CgogICAgLy8gYmFsYW5jZSBjaGFuZ2VkIGluIGluaXQKICAgIGRlcHMucXVlcmllci51cGRhdGVfYmFsYW5jZShNT0NLX0NPTlRSQUNUX0FERFIsIGluaXRfYW1vdW50KTsKCiAgICAvLyBub3QganVzdCAmcXVvdDthbnlib2R5JnF1b3Q7IGNhbiBzdGVhbCB0aGUgZnVuZHMKICAgIGxldCBtc2cgPSBIYW5kbGVNc2c6OlN0ZWFsIHsKICAgICAgICBkZXN0aW5hdGlvbjogSHVtYW5BZGRyOjpmcm9tKCZxdW90O2Jhbmt2YXVsdCZxdW90OyksCiAgICB9OwogICAgbGV0IGVudiA9IG1vY2tfZW52X2hlaWdodCgmYW1wO2RlcHMuYXBpLCAmcXVvdDthbnlib2R5JnF1b3Q7LCAmYW1wO1tdLCA5MDAsIDApOwogICAgbGV0IGhhbmRsZV9yZXMgPSBoYW5kbGUoJmFtcDttdXQgZGVwcywgZW52LCBtc2cuY2xvbmUoKSk7CiAgICBhc3NlcnQhKGhhbmRsZV9yZXMuaXNfZXJyKCkpOwoKICAgIC8vIG9ubHkgdGhlIG1hc3RlciB0aGllZgogICAgbGV0IG1zZyA9IEhhbmRsZU1zZzo6U3RlYWwgewogICAgICAgIGRlc3RpbmF0aW9uOiBIdW1hbkFkZHI6OmZyb20oJnF1b3Q7aGlkZW91dCZxdW90OyksCiAgICB9OwogICAgbGV0IGVudiA9IG1vY2tfZW52X2hlaWdodCgmYW1wO2RlcHMuYXBpLCBUSElFRiwgJmFtcDtbXSwgOTAwLCAwKTsKICAgIGxldCBoYW5kbGVfcmVzID0gaGFuZGxlKCZhbXA7bXV0IGRlcHMsIGVudiwgbXNnLmNsb25lKCkpLnVud3JhcCgpOwogICAgYXNzZXJ0X2VxISgxLCBoYW5kbGVfcmVzLm1lc3NhZ2VzLmxlbigpKTsKICAgIGxldCBtc2cgPSBoYW5kbGVfcmVzLm1lc3NhZ2VzLmdldCgwKS5leHBlY3QoJnF1b3Q7bm8gbWVzc2FnZSZxdW90Oyk7CiAgICBhc3NlcnRfZXEhKAogICAgICAgIG1zZywKICAgICAgICAmYW1wO0Nvc21vc01zZzo6QmFuayhCYW5rTXNnOjpTZW5kIHsKICAgICAgICAgICAgZnJvbV9hZGRyZXNzOiBIdW1hbkFkZHI6OmZyb20oTU9DS19DT05UUkFDVF9BRERSKSwKICAgICAgICAgICAgdG9fYWRkcmVzczogSHVtYW5BZGRyOjpmcm9tKCZxdW90O2hpZGVvdXQmcXVvdDspLAogICAgICAgICAgICBhbW91bnQ6IGNvaW5zKDEwMDAsICZxdW90O2VhcnRoJnF1b3Q7KSwKICAgICAgICB9KQogICAgKTsKfQo="}}),g._v(" "),C("p",[g._v("You will also have to add "),C("code",[g._v("MOCK_CONTRACT_ADDR")]),g._v(" to the test imports, like:")]),g._v(" "),C("code-block",{staticClass:"codeblock",attrs:{language:"rust",base64:"dXNlIGNvc213YXNtX3N0ZDo6dGVzdGluZzo6e21vY2tfZGVwZW5kZW5jaWVzLCBtb2NrX2VudiwgTU9DS19DT05UUkFDVF9BRERSfTsK"}})],1)}),[],!1,null,null,null);I.default=l.exports}}]);