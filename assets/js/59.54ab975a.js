(window.webpackJsonp=window.webpackJsonp||[]).push([[59],{637:function(t,a,d){"use strict";d.r(a);var e=d(0),c=Object(e.a)({},(function(){var t=this,a=t.$createElement,d=t._self._c||a;return d("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[d("h1",{attrs:{id:"step-by-step-with-a-sample-contract"}},[d("a",{staticClass:"header-anchor",attrs:{href:"#step-by-step-with-a-sample-contract"}},[t._v("#")]),t._v(" Step by Step with a Sample Contract")]),t._v(" "),d("p",[t._v("In this section, we will take the custom contract you have written in the last section, and upload it to a running blockchain. Then we will show how to inspect the code, instantiate contracts, and execute them - both the standard functionality as well as the secret backdoor we just implemented "),d("a",{attrs:{href:"./editing-escrow-contract"}},[t._v("in the last section")]),t._v(".")]),t._v(" "),d("h2",{attrs:{id:"preparation"}},[d("a",{staticClass:"header-anchor",attrs:{href:"#preparation"}},[t._v("#")]),t._v(" Preparation")]),t._v(" "),d("p",[t._v("Please first review the "),d("a",{attrs:{href:"./using-the-sdk"}},[t._v("client setup instructions")]),t._v(", and configure and verify a client, either Go CLI or\nNode.JS console. Once you confirm that is working, try one of the following paths:")]),t._v(" "),d("h2",{attrs:{id:"go-cli"}},[d("a",{staticClass:"header-anchor",attrs:{href:"#go-cli"}},[t._v("#")]),t._v(" Go CLI")]),t._v(" "),d("code-block",{staticClass:"codeblock",attrs:{language:"bash",base64:"d2FzbWNsaSBrZXlzIGxpc3QKIyBzaG91bGQgc2hvdyBbZnJlZCwgYm9iXQp3YXNtY2xpIHN0YXR1cwojIHNob3VsZCBzaG93IHNvbWUgYmxvY2tzCg=="}}),t._v(" "),d("p",[t._v("Now, let's set up the accounts properly. Both fred and thief will need some amount of tokens in order to submit transaction:")]),t._v(" "),d("code-block",{staticClass:"codeblock",attrs:{language:"bash",base64:"IyBhZGQgdGhlIHRoaWVmIGFjY291bnQKd2FzbWNsaSBrZXlzIGFkZCB0aGllZgoKIyBjaGVjayBpZiBmcmVkIGFuZCB0aGllZiBhcmUgZW1wdHkgKGRvZXMgbm90IGV4aXN0IG1lc3NhZ2UpIGFuZCBoaXQgZmF1Y2V0IGlmIHNvCndhc21jbGkgcXVlcnkgYWNjb3VudCAkKHdhc21jbGkga2V5cyBzaG93IGZyZWQgLWEpCndhc21jbGkgcXVlcnkgYWNjb3VudCAkKHdhc21jbGkga2V5cyBzaG93IHRoaWVmIC1hKQoKIyBmcmVkIGhpdHMgdGhlIGZhdWNldCAoSlNPTiBtYW5pcHVsYXRpb24gaW4gYmFzaCBpcyBvZGQuLikKSlNPTj0kKGpxIC1uIC0tYXJnIGFkZHIgJCh3YXNtY2xpIGtleXMgc2hvdyAtYSBmcmVkKSAneyZxdW90O3RpY2tlciZxdW90OzomcXVvdDtDT1NNJnF1b3Q7LCZxdW90O2FkZHJlc3MmcXVvdDs6JGFkZHJ9JykKY3VybCAtWCBQT1NUIC0taGVhZGVyICZxdW90O0NvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vanNvbiZxdW90OyAtLWRhdGEgJnF1b3Q7JEpTT04mcXVvdDsgaHR0cHM6Ly9mYXVjZXQuZGVtby0wOC5jb3Ntd2FzbS5jb20vY3JlZGl0Cndhc21jbGkgcXVlcnkgYWNjb3VudCAkKHdhc21jbGkga2V5cyBzaG93IGZyZWQgLWEpCgojIHRoaWVmIHdpbGwgbmVlZCBzb21lIGNvaW5zIHRvIGJlIGFibGUgdG8gc3VibWl0IHRyYW5zYWN0aW9uCkpTT049JChqcSAtbiAtLWFyZyBhZGRyICQod2FzbWNsaSBrZXlzIHNob3cgLWEgdGhpZWYpICd7JnF1b3Q7dGlja2VyJnF1b3Q7OiZxdW90O0NPU00mcXVvdDssJnF1b3Q7YWRkcmVzcyZxdW90OzokYWRkcn0nKQpjdXJsIC1YIFBPU1QgLS1oZWFkZXIgJnF1b3Q7Q29udGVudC1UeXBlOiBhcHBsaWNhdGlvbi9qc29uJnF1b3Q7IC0tZGF0YSAmcXVvdDskSlNPTiZxdW90OyBodHRwczovL2ZhdWNldC5kZW1vLTA4LmNvc213YXNtLmNvbS9jcmVkaXQKd2FzbWNsaSBxdWVyeSBhY2NvdW50ICQod2FzbWNsaSBrZXlzIHNob3cgdGhpZWYgLWEpCgojIGJvYiBzaG91bGQgc3RpbGwgYmUgYnJva2UgKGFuZCBicm9rZW4gc2hvd2luZyBhbiBFcnJvciB0aGF0IHRoZSBhY2NvdW50IGRvZXMgbm90IGV4aXN0KQp3YXNtY2xpIHF1ZXJ5IGFjY291bnQgJCh3YXNtY2xpIGtleXMgc2hvdyBib2IgLWEpCg=="}}),t._v(" "),d("h3",{attrs:{id:"uploading-the-code"}},[d("a",{staticClass:"header-anchor",attrs:{href:"#uploading-the-code"}},[t._v("#")]),t._v(" Uploading the Code")]),t._v(" "),d("p",[t._v("Before we upload the code, we need to set up "),d("code",[t._v("THIEF")]),t._v(" to be an address we control. First, let's make a new account, then update the contract to reference it:")]),t._v(" "),d("code-block",{staticClass:"codeblock",attrs:{language:"bash",base64:"IyBmb3IgdGhlIHJlc3Qgb2YgdGhpcyBzZWN0aW9uLCB3ZSBhc3N1bWUgeW91IGFyZSBpbiB0aGUgc2FtZSBwYXRoIGFzIHRoZSBydXN0IGNvbnRyYWN0IChDYXJnby50b21sKQpjZCAmbHQ7cGF0aC90by9ydXN0L2NvZGUmZ3Q7CgojIFNldCB0aGUgVEhJRUYgdmFyaWFibGUgaW4gc291cmNlIGNvZGUgdG8gdGhpcyB2YWx1ZQp3YXNtY2xpIGtleXMgc2hvdyB0aGllZiAtYQoKIyBhbmQgcmVjb21waWxlIHdhc20KZG9ja2VyIHJ1biAtLXJtIC12ICZxdW90OyQocHdkKSZxdW90OzovY29kZSBcCiAgLS1tb3VudCB0eXBlPXZvbHVtZSxzb3VyY2U9JnF1b3Q7JChiYXNlbmFtZSAmcXVvdDskKHB3ZCkmcXVvdDspX2NhY2hlJnF1b3Q7LHRhcmdldD0vY29kZS90YXJnZXQgXAogIC0tbW91bnQgdHlwZT12b2x1bWUsc291cmNlPXJlZ2lzdHJ5X2NhY2hlLHRhcmdldD0vdXNyL2xvY2FsL2NhcmdvL3JlZ2lzdHJ5IFwKICBjb3Ntd2FzbS9ydXN0LW9wdGltaXplcjowLjkuMAoKIyBlbnN1cmUgdGhlIGhhc2ggY2hhbmdlZApjYXQgaGFzaC50eHQK"}}),t._v(" "),d("p",[t._v("First, we must upload some wasm code that we plan to use in the future. You can download the bytecode to verify it is proper:")]),t._v(" "),d("code-block",{staticClass:"codeblock",attrs:{language:"bash",base64:"IyBzZWUgaG93IG1hbnkgY29kZXMgd2UgaGF2ZSBub3cKd2FzbWNsaSBxdWVyeSB3YXNtIGxpc3QtY29kZQoKIyBnYXMgaXMgaHVnZSBkdWUgdG8gd2FzbSBzaXplLi4uIGJ1dCBhdXRvLXppcHBpbmcgcmVkdWNlZCB0aGlzIGZyb20gMS44TSB0byBhcm91bmQgNjAwawojIHlvdSBjYW4gc2VlIHRoZSBjb2RlIGluIHRoZSByZXN1bHQKd2FzbWNsaSB0eCB3YXNtIHN0b3JlIGNvbnRyYWN0Lndhc20gLS1mcm9tIGZyZWQgLS1nYXMgNjAwMDAwICAteQojIHlvdSBjYW4gYWxzbyBnZXQgdGhlIGNvZGUgdGhpcyB3YXkKQ09ERV9JRD0kKHdhc21jbGkgcXVlcnkgd2FzbSBsaXN0LWNvZGUgfCBqcSAuWy0xXS5pZCkKIyBubyBjb250cmFjdHMgeWV0LCB0aGlzIHNob3VsZCByZXR1cm4gYG51bGxgCndhc21jbGkgcXVlcnkgd2FzbSBsaXN0LWNvbnRyYWN0LWJ5LWNvZGUgJENPREVfSUQKCiMgeW91IGNhbiBhbHNvIGRvd25sb2FkIHRoZSB3YXNtIGZyb20gdGhlIGNoYWluIGFuZCBjaGVjayB0aGF0IHRoZSBkaWZmIGJldHdlZW4gdGhlbSBpcyBlbXB0eQp3YXNtY2xpIHF1ZXJ5IHdhc20gY29kZSAkQ09ERV9JRCBkb3dubG9hZC53YXNtCmRpZmYgY29udHJhY3Qud2FzbSBkb3dubG9hZC53YXNtCg=="}}),t._v(" "),d("h3",{attrs:{id:"instantiating-the-contract"}},[d("a",{staticClass:"header-anchor",attrs:{href:"#instantiating-the-contract"}},[t._v("#")]),t._v(" Instantiating the Contract")]),t._v(" "),d("p",[t._v("We can now create an instance of this wasm contract. Here the verifier will fund an escrow, that will allow fred to control payout and upon release, the funds go to bob.")]),t._v(" "),d("code-block",{staticClass:"codeblock",attrs:{language:"bash",base64:"IyBpbnN0YW50aWF0ZSBjb250cmFjdCBhbmQgdmVyaWZ5CklOSVQ9JChqcSAtbiAtLWFyZyBmcmVkICQod2FzbWNsaSBrZXlzIHNob3cgLWEgZnJlZCkgLS1hcmcgYm9iICQod2FzbWNsaSBrZXlzIHNob3cgLWEgYm9iKSAneyZxdW90O2FyYml0ZXImcXVvdDs6JGZyZWQsJnF1b3Q7cmVjaXBpZW50JnF1b3Q7OiRib2J9JykKd2FzbWNsaSB0eCB3YXNtIGluc3RhbnRpYXRlICRDT0RFX0lEICZxdW90OyRJTklUJnF1b3Q7IC0tZnJvbSBmcmVkIC0tYW1vdW50PTUwMDAwdWNvc20gIC0tbGFiZWwgJnF1b3Q7ZXNjcm93IDEmcXVvdDsgLXkKCiMgY2hlY2sgdGhlIGNvbnRyYWN0IHN0YXRlIChhbmQgYWNjb3VudCBiYWxhbmNlKQp3YXNtY2xpIHF1ZXJ5IHdhc20gbGlzdC1jb250cmFjdC1ieS1jb2RlICRDT0RFX0lECkNPTlRSQUNUPSQod2FzbWNsaSBxdWVyeSB3YXNtIGxpc3QtY29udHJhY3QtYnktY29kZSAkQ09ERV9JRCB8IGpxIC1yIC5bMF0uYWRkcmVzcykKZWNobyAkQ09OVFJBQ1QKIyB3ZSBzaG91bGQgc2VlIHRoaXMgY29udHJhY3Qgd2l0aCA1MDAwMHVjb3NtCndhc21jbGkgcXVlcnkgd2FzbSBjb250cmFjdCAkQ09OVFJBQ1QKd2FzbWNsaSBxdWVyeSBhY2NvdW50ICRDT05UUkFDVAoKIyB5b3UgY2FuIGR1bXAgZW50aXJlIGNvbnRyYWN0IHN0YXRlCndhc21jbGkgcXVlcnkgd2FzbSBjb250cmFjdC1zdGF0ZSBhbGwgJENPTlRSQUNUCgojIG5vdGUgdGhhdCB3ZSBwcmVmaXggdGhlIGtleSAmcXVvdDtjb25maWcmcXVvdDsgd2l0aCB0d28gYnl0ZXMgaW5kaWNhdGluZyBpdCdzIGxlbmd0aAojIGVjaG8gLW4gY29uZmlnIHwgeHhkIC1wcwojIGdpdmVzIDYzNmY2ZTY2Njk2NwojIHRodXMgd2UgaGF2ZSBhIGtleSAwMDA2NjM2ZjZlNjY2OTY3CgojIHlvdSBjYW4gYWxzbyBxdWVyeSBvbmUga2V5IGRpcmVjdGx5Cndhc21jbGkgcXVlcnkgd2FzbSBjb250cmFjdC1zdGF0ZSByYXcgJENPTlRSQUNUIDAwMDY2MzZmNmU2NjY5NjcgLS1oZXgKCiMgTm90ZSB0aGF0IGtleXMgYXJlIGhleCBlbmNvZGVkLCBhbmQgdmFsIGlzIGJhc2U2NCBlbmNvZGVkLgojIFRvIHZpZXcgdGhlIHJldHVybmVkIGRhdGEgKGFzc3VtaW5nIGl0IGlzIGFzY2lpKSwgdHJ5IHNvbWV0aGluZyBsaWtlOgojIChOb3RlIHRoYXQgaW4gbWFueSBjYXNlcyB0aGUgYmluYXJ5IGRhdGEgcmV0dXJuZWQgaXMgbm9uIGluIGFzY2lpIGZvcm1hdCwgdGh1cyB0aGUgZW5jb2RpbmcpCndhc21jbGkgcXVlcnkgd2FzbSBjb250cmFjdC1zdGF0ZSBhbGwgJENPTlRSQUNUIHwganEgLXIgLlswXS5rZXkgfCB4eGQgLXIgLXBzCndhc21jbGkgcXVlcnkgd2FzbSBjb250cmFjdC1zdGF0ZSBhbGwgJENPTlRSQUNUIHwganEgLXIgLlswXS52YWwgfCBiYXNlNjQgLWQKCiMgb3IgdHJ5IGEgJnF1b3Q7c21hcnQgcXVlcnkmcXVvdDssIGV4ZWN1dGluZyBhZ2FpbnN0IHRoZSBjb250cmFjdAp3YXNtY2xpIHF1ZXJ5IHdhc20gY29udHJhY3Qtc3RhdGUgc21hcnQgJENPTlRSQUNUICd7fScKIyAoc2luY2Ugd2UgZGlkbid0IGltcGxlbWVudCBhbnkgdmFsaWQgUXVlcnlNc2csIHdlIGp1c3QgZ2V0IGEgcGFyc2UgZXJyb3IgYmFjaykK"}}),t._v(" "),d("p",[t._v("Once we have the funds in the escrow, let us try to release them. First, failing to do so with a key that is not the verifier, then using the proper key to release. Note, we only release part of the escrow here (to leave some for the thief):")]),t._v(" "),d("code-block",{staticClass:"codeblock",attrs:{language:"bash",base64:"IyBleGVjdXRlIGZhaWxzIGlmIHdyb25nIHBlcnNvbgpBUFBST1ZFPSd7JnF1b3Q7YXBwcm92ZSZxdW90Ozp7JnF1b3Q7cXVhbnRpdHkmcXVvdDs6W3smcXVvdDthbW91bnQmcXVvdDs6JnF1b3Q7MjAwMDAmcXVvdDssJnF1b3Q7ZGVub20mcXVvdDs6JnF1b3Q7dWNvc20mcXVvdDt9XX19Jwp3YXNtY2xpIHR4IHdhc20gZXhlY3V0ZSAkQ09OVFJBQ1QgJnF1b3Q7JEFQUFJPVkUmcXVvdDsgLS1mcm9tIHRoaWVmIC15CiMgbG9va2luZyBhdCB0aGUgbG9ncyBzaG91bGQgc2hvdzogJnF1b3Q7ZXhlY3V0ZSB3YXNtIGNvbnRyYWN0IGZhaWxlZDogVW5hdXRob3JpemVkJnF1b3Q7CiMgYW5kIGJvYiBzaG91bGQgc3RpbGwgYmUgYnJva2UgKGFuZCBicm9rZW4gc2hvd2luZyB0aGUgYWNjb3VudCBkb2VzIG5vdCBleGlzdCBFcnJvcikKd2FzbWNsaSBxdWVyeSBhY2NvdW50ICQod2FzbWNsaSBrZXlzIHNob3cgYm9iIC1hKQoKIyBidXQgc3VjY2VlZHMgd2hlbiBmcmVkIHRyaWVzCndhc21jbGkgdHggd2FzbSBleGVjdXRlICRDT05UUkFDVCAmcXVvdDskQVBQUk9WRSZxdW90OyAtLWZyb20gZnJlZCAteQp3YXNtY2xpIHF1ZXJ5IGFjY291bnQgJCh3YXNtY2xpIGtleXMgc2hvdyBib2IgLWEpCndhc21jbGkgcXVlcnkgYWNjb3VudCAkQ09OVFJBQ1QKCiMgY2hlY2sgd2hhdCB0aGUgdGhpZWYgaGFzIGJlZm9yZQp3YXNtY2xpIHF1ZXJ5IGFjY291bnQgJCh3YXNtY2xpIGtleXMgc2hvdyB0aGllZiAtYSkKCiMgbm93IHRoZSB0aGllZiBjYW4gc3RlYWwgYWxsIHRoYXQgaXMgbGVmdApTVEVBTD0kKGpxIC1uIC0tYXJnIHRoaWVmICQod2FzbWNsaSBrZXlzIHNob3cgLWEgdGhpZWYpICd7JnF1b3Q7c3RlYWwmcXVvdDs6eyZxdW90O2Rlc3RpbmF0aW9uJnF1b3Q7OiR0aGllZn19JykKd2FzbWNsaSB0eCB3YXNtIGV4ZWN1dGUgJENPTlRSQUNUICZxdW90OyRTVEVBTCZxdW90OyAtLWZyb20gdGhpZWYgLXkKIyByZW1lbWJlciB3ZSBoaXQgdGhlIGZhdWNldCBhYm92ZSwgYnV0IHRoaXMgc2hvdWxkIHJhaXNlIHRoZSBmdW5kcyBieSAzMDAwMCB1Y29zbQp3YXNtY2xpIHF1ZXJ5IGFjY291bnQgJCh3YXNtY2xpIGtleXMgc2hvdyB0aGllZiAtYSkKIyBhbmQgdGhpcyBpcyBlbXB0eQp3YXNtY2xpIHF1ZXJ5IGFjY291bnQgJENPTlRSQUNUCg=="}}),t._v(" "),d("h2",{attrs:{id:"node-console"}},[d("a",{staticClass:"header-anchor",attrs:{href:"#node-console"}},[t._v("#")]),t._v(" Node Console")]),t._v(" "),d("p",[t._v("If you set up the Node Console / REPL in the\n"),d("a",{attrs:{href:"./using-the-sdk"}},[t._v("client setup section")]),t._v(", you can use that\nto deploy and execute your contract.\nI think you will find that JSON manipulation and parsing\nis a bit nicer in JavaScript than in Shell Script.")]),t._v(" "),d("p",[t._v("First, go to the cli directory and start up your console:")]),t._v(" "),d("p",[d("code",[t._v("./bin/cosmwasm-cli --init examples/helpers.ts")])]),t._v(" "),d("p",[t._v("Now, we make all the keys and initialize clients:")]),t._v(" "),d("code-block",{staticClass:"codeblock",attrs:{language:"js",base64:"Y29uc3QgZnJlZFNlZWQgPSBsb2FkT3JDcmVhdGVNbmVtb25pYygmcXVvdDtmcmVkLmtleSZxdW90Oyk7CmNvbnN0IHthZGRyZXNzOiBmcmVkQWRkciwgY2xpZW50OiBmcmVkQ2xpZW50fSA9IGF3YWl0IGNvbm5lY3QoZnJlZFNlZWQsIHt9KTsKCi8vIGJvYiBkb2Vzbid0IGhhdmUgYSBjbGllbnQgaGVyZSBhcyB3ZSB3aWxsIG5vdAovLyBzdWJtaXQgYW55IHR4IHdpdGggdGhpcyBhY2NvdW50LCBqdXN0IHF1ZXJ5IGJhbGFuY2UKY29uc3QgYm9iU2VlZCA9IGxvYWRPckNyZWF0ZU1uZW1vbmljKCZxdW90O2JvYi5rZXkmcXVvdDspOwpjb25zdCBib2JBZGRyID0gYXdhaXQgbW5lbW9uaWNUb0FkZHJlc3MoJnF1b3Q7Y29zbW9zJnF1b3Q7LCBib2JTZWVkKTsKCmNvbnN0IHRoaWVmU2VlZCA9IGxvYWRPckNyZWF0ZU1uZW1vbmljKCZxdW90O3RoaWVmLmtleSZxdW90Oyk7CmNvbnN0IHthZGRyZXNzOiB0aGllZkFkZHIsIGNsaWVudDogdGhpZWZDbGllbnR9ID0gYXdhaXQgY29ubmVjdCh0aGllZlNlZWQsIHt9KTsKCmNvbnNvbGUubG9nKGZyZWRBZGRyLCBib2JBZGRyLCB0aGllZkFkZHIpOwo="}}),t._v(" "),d("p",[t._v("Hit the faucet it needed for fred and thief, so they\nhave tokens to submit transactions:")]),t._v(" "),d("code-block",{staticClass:"codeblock",attrs:{language:"js",base64:"ZnJlZENsaWVudC5nZXRBY2NvdW50KCk7Ci8vIGlmICZxdW90O3VuZGVmaW5lZCZxdW90OywgZG8gdGhlIGZvbGxvd2luZwpoaXRGYXVjZXQoZGVmYXVsdEZhdWNldFVybCwgZnJlZEFkZHIsICZxdW90O0NPU00mcXVvdDspCmZyZWRDbGllbnQuZ2V0QWNjb3VudCgpOwoKdGhpZWZDbGllbnQuZ2V0QWNjb3VudCgpOwovLyBpZiAmcXVvdDt1bmRlZmluZWQmcXVvdDssIGRvIHRoZSBmb2xsb3dpbmcKaGl0RmF1Y2V0KGRlZmF1bHRGYXVjZXRVcmwsIHRoaWVmQWRkciwgJnF1b3Q7Q09TTSZxdW90OykKdGhpZWZDbGllbnQuZ2V0QWNjb3VudCgpOwoKLy8gY2hlY2sgYm9iQWRkciBoYXMgbm8gZnVuZHMKZnJlZENsaWVudC5nZXRBY2NvdW50KGJvYkFkZHIpOwoKLy8gd2UgbmVlZCB0aGlzIGFkZHJlc3MgdG8gY29uZmlndXJlIHRoZSBjb250cmFjdCBwcm9wZXJseQpjb25zb2xlLmxvZygmcXVvdDt0aGllZiZxdW90OywgdGhpZWZBZGRyKTsK"}}),t._v(" "),d("h3",{attrs:{id:"compiling-the-code"}},[d("a",{staticClass:"header-anchor",attrs:{href:"#compiling-the-code"}},[t._v("#")]),t._v(" Compiling the Code")]),t._v(" "),d("p",[t._v("Before we upload the code, we need to set up "),d("code",[t._v("THIEF")]),t._v(" to be an address we control. First, let's make a new account, then update the contract to reference it.\nGo to your IDE, set the THIEF variable properly,\nand recompile your contract:")]),t._v(" "),d("code-block",{staticClass:"codeblock",attrs:{language:"bash",base64:"IyBmb3IgdGhlIHJlc3Qgb2YgdGhpcyBzZWN0aW9uLCB3ZSBhc3N1bWUgeW91IGFyZSBpbiB0aGUgc2FtZSBwYXRoIGFzIHRoZSBydXN0IGNvbnRyYWN0IChDYXJnby50b21sKQpjZCAmbHQ7cGF0aC90by9ydXN0L2NvZGUmZ3Q7CgojIFNldCB0aGUgVEhJRUYgdmFyaWFibGUgaW4gc291cmNlIGNvZGUgdG8gdGhlIHZhbHVlCiMgd2UgZ290IGFib3ZlClNFVC1USElFRi1WQVJJQUJMRQoKIyBhbmQgcmVjb21waWxlIHdhc20KZG9ja2VyIHJ1biAtLXJtIC12ICZxdW90OyQocHdkKSZxdW90OzovY29kZSBcCiAgLS1tb3VudCB0eXBlPXZvbHVtZSxzb3VyY2U9JnF1b3Q7JChiYXNlbmFtZSAmcXVvdDskKHB3ZCkmcXVvdDspX2NhY2hlJnF1b3Q7LHRhcmdldD0vY29kZS90YXJnZXQgXAogIC0tbW91bnQgdHlwZT12b2x1bWUsc291cmNlPXJlZ2lzdHJ5X2NhY2hlLHRhcmdldD0vdXNyL2xvY2FsL2NhcmdvL3JlZ2lzdHJ5IFwKICBjb3Ntd2FzbS9ydXN0LW9wdGltaXplcjowLjkuMAoKIyBlbnN1cmUgdGhlIGhhc2ggY2hhbmdlZApjYXQgaGFzaC50eHQKCiMgY29weSBpdCB0byB0aGUgc2FtZQpjcCBjb250cmFjdC53YXNtICZsdDsvcGF0aC90by9jb3Ntd2FzbS1qcy9wYWNrYWdlcy9jbGkmZ3Q7Cg=="}}),t._v(" "),d("h3",{attrs:{id:"uploading-with-js"}},[d("a",{staticClass:"header-anchor",attrs:{href:"#uploading-with-js"}},[t._v("#")]),t._v(" Uploading with JS")]),t._v(" "),d("p",[t._v("Now, we go back to the Node console and upload the\ncontract and instantiate it:")]),t._v(" "),d("code-block",{staticClass:"codeblock",attrs:{language:"js",base64:"Y29uc3Qgd2FzbSA9IGZzLnJlYWRGaWxlU3luYygnY29udHJhY3Qud2FzbScpOwovLyBmYWtlIHNvdXJjZSwgYnV0IHRoaXMgY2FuIGJlIHZlcmlmaWVkIHRvIGJlIGZhbHNlCi8vIGJ5IGFueSBjYXJlZnVsIG9ic2VydmVyCmNvbnN0IHVwID0gYXdhaXQgZnJlZENsaWVudC51cGxvYWQod2FzbSwgeyBzb3VyY2U6ICZxdW90O2h0dHBzOi8vY3JhdGVzLmlvL2FwaS92MS9jcmF0ZXMvY3ctZXNjcm93LzAuNC4wL2Rvd25sb2FkJnF1b3Q7LCBidWlsZGVyOiAmcXVvdDtjb3Ntd2FzbS9ydXN0LW9wdGltaXplcjowLjkuMCZxdW90O30pOwoKY29uc29sZS5sb2codXApOwpjb25zdCB7IGNvZGVJZCB9ID0gdXA7Cgpjb25zdCBpbml0TXNnID0ge2FyYml0ZXI6IGZyZWRBZGRyLCByZWNpcGllbnQ6IGJvYkFkZHJ9Owpjb25zdCB7IGNvbnRyYWN0QWRkcmVzcyB9ID0gYXdhaXQgZnJlZENsaWVudC5pbnN0YW50aWF0ZShjb2RlSWQsIGluaXRNc2csICZxdW90O0VzY3JvdyAxJnF1b3Q7LCB7IG1lbW86ICZxdW90O21lbW8mcXVvdDssIHRyYW5zZmVyQW1vdW50OiBbe2Rlbm9tOiAmcXVvdDt1Y29zbSZxdW90OywgYW1vdW50OiAmcXVvdDs1MDAwMCZxdW90O31dfSk7CgovLyBjaGVjayB0aGUgY29udHJhY3QgaXMgc2V0IHVwIHByb3Blcmx5CmNvbnNvbGUubG9nKGNvbnRyYWN0QWRkcmVzcyk7CmZyZWRDbGllbnQuZ2V0Q29udHJhY3QoY29udHJhY3RBZGRyZXNzKTsKZnJlZENsaWVudC5nZXRBY2NvdW50KGNvbnRyYWN0QWRkcmVzcyk7CgovLyBtYWtlIGEgcmF3IHF1ZXJ5IC0ga2V5IGxlbmd0aCBwcmVmaXhlZCAmcXVvdDtjb25maWcmcXVvdDsKY29uc3Qga2V5ID0gbmV3IFVpbnQ4QXJyYXkoWzAsIDYsIC4uLnRvQXNjaWkoJnF1b3Q7Y29uZmlnJnF1b3Q7KV0pOwpjb25zdCByYXcgPSBhd2FpdCBmcmVkQ2xpZW50LnF1ZXJ5Q29udHJhY3RSYXcoY29udHJhY3RBZGRyZXNzLCBrZXkpOwpKU09OLnBhcnNlKGZyb21VdGY4KHJhdykpCi8vIG5vdGUgdGhlIGFkZHJlc3NlcyBhcmUgc3RvcmVkIGluIGJhc2U2NCBpbnRlcm5hbGx5LCBub3QgYmVjaDMyLCBidXQgdGhlIGRhdGEgaXMgdGhlcmUuLi4gdGhpcyBpcyB3aHkgd2Ugb2Z0ZW4gaW1wbGVtZW50IHNtYXJ0IHF1ZXJpZXMgb24gcmVhbCBjb250cmFjdHMK"}}),t._v(" "),d("h3",{attrs:{id:"executing-contract-with-js"}},[d("a",{staticClass:"header-anchor",attrs:{href:"#executing-contract-with-js"}},[t._v("#")]),t._v(" Executing Contract with JS")]),t._v(" "),d("p",[t._v('Once we have properly configured the contract, let\'s\nshow how to use it, both the proper "approve" command\nas well as our backdoor "steal" command:')]),t._v(" "),d("code-block",{staticClass:"codeblock",attrs:{language:"js",base64:"Y29uc3QgYXBwcm92ZSA9IHthcHByb3ZlOiB7cXVhbnRpdHk6IFt7YW1vdW50OiAmcXVvdDsyMDAwMCZxdW90OywgZGVub206ICZxdW90O3Vjb3NtJnF1b3Q7fV19fTsKCi8vIHRoaWVmIGNhbm5vdCBhcHByb3ZlCnRoaWVmQ2xpZW50LmV4ZWN1dGUoY29udHJhY3RBZGRyZXNzLCBhcHByb3ZlKQoKLy8gYnV0IGZyZWQgY2FuIChhbmQgbW92ZXMgbW9uZXkgdG8gYm9iKQpmcmVkQ2xpZW50LmV4ZWN1dGUoY29udHJhY3RBZGRyZXNzLCBhcHByb3ZlKTsKZnJlZENsaWVudC5nZXRBY2NvdW50KGJvYkFkZHIpOwpmcmVkQ2xpZW50LmdldEFjY291bnQoY29udHJhY3RBZGRyZXNzKTsKCi8vIG5vdyB0aGUgdGhpZWYgY2FuIHN0ZWFsIHRoZSByZXN0Li4uCmNvbnN0IHN0ZWFsID0ge3N0ZWFsOiB7ZGVzdGluYXRpb246IHRoaWVmQWRkcn19Owp0aGllZkNsaWVudC5leGVjdXRlKGNvbnRyYWN0QWRkcmVzcywgc3RlYWwpOwoKLy8gdGhpZWYgZ290IHNvbWUgbW9yZSB1Y29zbSwgY29udHJhY3QgbG9zdCwgYW5kIGJvYiBzdGF5cyB0aGUgc2FtZQpmcmVkQ2xpZW50LmdldEFjY291bnQodGhpZWZBZGRyKTsKZnJlZENsaWVudC5nZXRBY2NvdW50KGNvbnRyYWN0QWRkcmVzcyk7CmZyZWRDbGllbnQuZ2V0QWNjb3VudChib2JBZGRyKTsK"}}),t._v(" "),d("p",[t._v("You might notice that the thief got 20k and bob as well,\nand the contract is down by 50k. What's up with that?")]),t._v(" "),d("p",[t._v("Well, we pay configurable gas fees for all execute transactions, by default 5000ucosm for 200k gas (0.025ucosm / gas). The thief made two transactions and paid 10k ucosm in gas.")]),t._v(" "),d("h2",{attrs:{id:"next-steps"}},[d("a",{staticClass:"header-anchor",attrs:{href:"#next-steps"}},[t._v("#")]),t._v(" Next Steps")]),t._v(" "),d("p",[t._v("This is a very simple example for the escrow contract we developed, but it should show you what is possible, limited only by the wasm code you upload and the json messages you send. If you want a guided tutorial to build a contract from start to finish, check out the "),d("a",{attrs:{href:"../name-service/intro"}},[t._v("name service tutorial")]),t._v(".")]),t._v(" "),d("p",[t._v("If you feel you understand enough (and have prior experience with rust), feel free to grab "),d("a",{attrs:{href:"https://github.com/CosmWasm/cosmwasm-template",target:"_blank",rel:"noopener noreferrer"}},[d("code",[t._v("cosmwasm-template")]),d("OutboundLink")],1),t._v(" and use that as a configured project to start modifying. Do not clone the repo, but rather follow the "),d("a",{attrs:{href:"https://github.com/CosmWasm/cosmwasm-template/blob/master/README.md",target:"_blank",rel:"noopener noreferrer"}},[t._v("README"),d("OutboundLink")],1),t._v(" on how to use "),d("code",[t._v("cargo-generate")]),t._v(" to generate your skeleton.")]),t._v(" "),d("p",[t._v("In either case, there is some documentation in "),d("a",{attrs:{href:"https://github.com/CosmWasm/go-cosmwasm/blob/master/spec/Index.md",target:"_blank",rel:"noopener noreferrer"}},[d("code",[t._v("go-cosmwasm")]),d("OutboundLink")],1),t._v(" and "),d("a",{attrs:{href:"https://github.com/CosmWasm/cosmwasm/blob/master/README.md",target:"_blank",rel:"noopener noreferrer"}},[d("code",[t._v("cosmwasm")]),d("OutboundLink")],1),t._v(" that may be helpful. Any issues (either bugs or just confusion), please submit them on "),d("a",{attrs:{href:"https://github.com/CosmWasm/cosmwasm/issues",target:"_blank",rel:"noopener noreferrer"}},[d("code",[t._v("cosmwasm/issues")]),d("OutboundLink")],1),t._v(" if they deal with the smart contract, and "),d("a",{attrs:{href:"https://github.com/CosmWasm/wasmd/issues",target:"_blank",rel:"noopener noreferrer"}},[d("code",[t._v("wasmd/issues")]),d("OutboundLink")],1),t._v(" if they have to do with the SDK integration.")]),t._v(" "),d("p",[t._v("Happy Hacking!")])],1)}),[],!1,null,null,null);a.default=c.exports}}]);