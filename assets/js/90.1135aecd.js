(window.webpackJsonp=window.webpackJsonp||[]).push([[90],{679:function(t,e,s){"use strict";s.r(e);var a=s(0),c=Object(a.a)({},(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"develop-contract"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#develop-contract"}},[t._v("#")]),t._v(" Develop Contract")]),t._v(" "),s("iframe",{attrs:{src:"https://player.vimeo.com/video/457702442",width:"640",height:"360",frameborder:"0",allow:"autoplay; fullscreen",allowfullscreen:""}}),t._v(" "),s("p",[t._v("First test if the starter works, and get your eyes used to rust test results:")]),t._v(" "),s("code-block",{staticClass:"codeblock",attrs:{language:"shell",base64:"Y2FyZ28gdW5pdC10ZXN0CiAgIENvbXBpbGluZyBwcm9jLW1hY3JvMiB2MS4wLjIxCiAgIENvbXBpbGluZyB1bmljb2RlLXhpZCB2MC4yLjEKICAgQ29tcGlsaW5nIHN5biB2MS4wLjQwCiAgIENvbXBpbGluZyBzZXJkZV9kZXJpdmUgdjEuMC4xMTYKICAgQ29tcGlsaW5nIHNlcmRlIHYxLjAuMTE2CiAgIENvbXBpbGluZyBhdXRvY2ZnIHYxLjAuMQogICBDb21waWxpbmcgcnl1IHYxLjAuNQogICBDb21waWxpbmcgbGliYyB2MC4yLjc3CiAgIENvbXBpbGluZyBzZXJkZV9qc29uIHYxLjAuNTcKICAgQ29tcGlsaW5nIGl0b2EgdjAuNC42CiAgIENvbXBpbGluZyBhZGxlciB2MC4yLjMKICAgQ29tcGlsaW5nIGRvYy1jb21tZW50IHYwLjMuMwogICBDb21waWxpbmcgZ2ltbGkgdjAuMjIuMAogICBDb21waWxpbmcgc2NoZW1hcnMgdjAuNy42CiAgIENvbXBpbGluZyBydXN0Yy1kZW1hbmdsZSB2MC4xLjE2CiAgIENvbXBpbGluZyBvYmplY3QgdjAuMjAuMAogICBDb21waWxpbmcgY2ZnLWlmIHYwLjEuMTAKICAgQ29tcGlsaW5nIGJhc2U2NCB2MC4xMS4wCiAgIENvbXBpbGluZyBtaW5pel9veGlkZSB2MC40LjIKICAgQ29tcGlsaW5nIHF1b3RlIHYxLjAuNwogICBDb21waWxpbmcgYWRkcjJsaW5lIHYwLjEzLjAKICAgQ29tcGlsaW5nIGJhY2t0cmFjZSB2MC4zLjUwCiAgIENvbXBpbGluZyBzZXJkZV9kZXJpdmVfaW50ZXJuYWxzIHYwLjI1LjAKICAgQ29tcGlsaW5nIHNjaGVtYXJzX2Rlcml2ZSB2MC43LjYKICAgQ29tcGlsaW5nIHNuYWZ1LWRlcml2ZSB2MC42LjgKICAgQ29tcGlsaW5nIHNuYWZ1IHYwLjYuOAogICBDb21waWxpbmcgc2VyZGUtanNvbi13YXNtIHYwLjIuMQogICBDb21waWxpbmcgY29zbXdhc20tc3RkIHYwLjEwLjEKICAgQ29tcGlsaW5nIGNvc213YXNtLXNjaGVtYSB2MC4xMC4xCiAgIENvbXBpbGluZyBjb3Ntd2FzbS1zdG9yYWdlIHYwLjEwLjEKICAgQ29tcGlsaW5nIHNpbXBsZS1vcHRpb24gdjAuMS4wICh+L3NpbXBsZS1vcHRpb24pCiAgICBGaW5pc2hlZCB0ZXN0IFt1bm9wdGltaXplZCArIGRlYnVnaW5mb10gdGFyZ2V0KHMpIGluIDFtIDE5cwogICAgIFJ1bm5pbmcgdGFyZ2V0L2RlYnVnL2RlcHMvc2ltcGxlX29wdGlvbi04YmExMzdlMTEzNzIwOTkwCgpydW5uaW5nIDQgdGVzdHMKdGVzdCBjb250cmFjdDo6dGVzdHM6OnByb3Blcl9pbml0aWFsaXphdGlvbiAuLi4gb2sKdGVzdCBjb250cmFjdDo6dGVzdHM6OnRyYW5zZmVyIC4uLiBvawp0ZXN0IGNvbnRyYWN0Ojp0ZXN0czo6YnVybiAuLi4gb2sKdGVzdCBjb250cmFjdDo6dGVzdHM6OmV4ZWN1dGUgLi4uIG9rCgp0ZXN0IHJlc3VsdDogb2suIDQgcGFzc2VkOyAwIGZhaWxlZDsgMCBpZ25vcmVkOyAwIG1lYXN1cmVkOyAwIGZpbHRlcmVkIG91dAo="}}),t._v(" "),s("p",[t._v("All good.")]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",[t._v("Timecode "),s("a",{attrs:{href:"https://vimeo.com/457702442#t=39s",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://vimeo.com/457702442#t=39s"),s("OutboundLink")],1)])]),t._v(" "),s("p",[s("a",{attrs:{href:"https://github.com/CosmWasm/cosmwasm-examples/blob/master/simple-option/src/lib.rs",target:"_blank",rel:"noopener noreferrer"}},[t._v("src/lib.rs"),s("OutboundLink")],1),t._v(" file contains wasm bindings. Wraps smart contract "),s("em",[t._v("(handle, init, query)")]),t._v(" functions around rust functions. If you are not doing advanced wasm tweaking, don't touch it.")]),t._v(" "),s("h2",{attrs:{id:"messages"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#messages"}},[t._v("#")]),t._v(" Messages")]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",[t._v("Timecode "),s("a",{attrs:{href:"https://vimeo.com/457702442#t=1m46s",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://vimeo.com/457702442#t=1m46s"),s("OutboundLink")],1)])]),t._v(" "),s("p",[t._v("Development begins in "),s("a",{attrs:{href:"https://github.com/CosmWasm/cosmwasm-examples/blob/master/simple-option/src/msg.rs",target:"_blank",rel:"noopener noreferrer"}},[t._v("src/msg.rs"),s("OutboundLink")],1),t._v(" which contains the input data structures of the smart contract.")]),t._v(" "),s("h3",{attrs:{id:"initmsg"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#initmsg"}},[t._v("#")]),t._v(" InitMsg")]),t._v(" "),s("p",[t._v("We will begin with "),s("a",{attrs:{href:"https://github.com/CosmWasm/cosmwasm-examples/blob/master/simple-option/src/msg.rs",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("InitMsg")]),s("OutboundLink")],1),t._v(". This struct has the initial values that initializes smart contract from the code and feeds in the data required for logic setup.")]),t._v(" "),s("code-block",{staticClass:"codeblock",attrs:{language:"rust",base64:"I1tkZXJpdmUoU2VyaWFsaXplLCBEZXNlcmlhbGl6ZSwgQ2xvbmUsIERlYnVnLCBQYXJ0aWFsRXEsIEpzb25TY2hlbWEpXQpwdWIgc3RydWN0IEluaXRNc2cgewogICAgLy8gb3duZXIgYW5kIGNyZWF0b3IgY29tZSBmcm9tIGVudgogICAgLy8gY29sbGF0ZXJhbCBjb21lcyBmcm9tIGVudgogICAgcHViIGNvdW50ZXJfb2ZmZXI6IFZlYyZsdDtDb2luJmd0OywKICAgIHB1YiBleHBpcmVzOiB1NjQsCn0K"}}),t._v(" "),s("p",[s("code",[t._v("#[derive(Serialize, Deserialize, Clone, Debug, PartialEq, JsonSchema)]")]),t._v(" implements specified traits for this structure using macros. More read "),s("a",{attrs:{href:"https://doc.rust-lang.org/stable/rust-by-example/trait/derive.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Rust docs / Derive"),s("OutboundLink")],1)]),t._v(" "),s("div",{staticClass:"custom-block warning"},[s("ul",[s("li",[s("em",[t._v("Owner")]),t._v(", "),s("em",[t._v("creator")]),t._v(" and "),s("em",[t._v("collateral")]),t._v(" comes from message transaction context, meaning owner and creator is the address signed the tx and collateral is funds sent along the message.")]),t._v(" "),s("li",[s("em",[t._v("counter_offer")]),t._v(" is "),s("a",{attrs:{href:"https://www.investopedia.com/terms/s/strikeprice.asp",target:"_blank",rel:"noopener noreferrer"}},[t._v("strike price"),s("OutboundLink")],1),t._v(".")])])]),t._v(" "),s("h3",{attrs:{id:"handlemsg"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#handlemsg"}},[t._v("#")]),t._v(" HandleMsg")]),t._v(" "),s("p",[t._v("Contract execution is branched using "),s("code",[t._v("HandleMsg")]),t._v(" enum. Each field defines a message and content of that message.")]),t._v(" "),s("code-block",{staticClass:"codeblock",attrs:{language:"rust",base64:"I1tkZXJpdmUoU2VyaWFsaXplLCBEZXNlcmlhbGl6ZSwgQ2xvbmUsIERlYnVnLCBQYXJ0aWFsRXEsIEpzb25TY2hlbWEpXQojW3NlcmRlKHJlbmFtZV9hbGwgPSAmcXVvdDtzbmFrZV9jYXNlJnF1b3Q7KV0KcHViIGVudW0gSGFuZGxlTXNnIHsKICAgIC8vLyBPd25lciBjYW4gdHJhbnNmZXIgdG8gYSBuZXcgb3duZXIKICAgIFRyYW5zZmVyIHsgcmVjaXBpZW50OiBIdW1hbkFkZHIgfSwKICAgIC8vLyBPd25lciBjYW4gcG9zdCBjb3VudGVyX29mZmVyIG9uIHVuZXhwaXJlZCBvcHRpb24gdG8gZXhlY3V0ZSBhbmQgZ2V0IHRoZSBjb2xsYXRlcmFsCiAgICBFeGVjdXRlIHt9LAogICAgLy8vIEJ1cm4gd2lsbCByZWxlYXNlIGNvbGxhdGVyYWwgaWYgZXhwaXJlZAogICAgQnVybiB7fSwKfQo="}}),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",[t._v("Canonical and Human Addresses\nCanonical Addresses represent binary format of crypto addresses.\nHuman Addresses on the other hand are great for the UI. They are always a subset of ascii text, and often contain security checks - such as chain-prefix in Bech32, e.g. cosmos1h57760w793q6vh06jsppnqdkc4ejcuyrrjxnke")]),t._v(" "),s("p",[s("code",[t._v("canonicalize(humanize(canonical_addr)) == canonical_addr")])]),t._v(" "),s("p",[t._v("For more details: "),s("a",{attrs:{href:"https://docs.cosmwasm.com/architecture/addresses.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Names and Addresses"),s("OutboundLink")],1)])]),t._v(" "),s("h3",{attrs:{id:"querymsg"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#querymsg"}},[t._v("#")]),t._v(" QueryMsg")]),t._v(" "),s("p",[t._v("Smart contract state querying is branched using "),s("code",[t._v("QueryEnum")]),t._v(". We will implement smart contract "),s("code",[t._v("Config")]),t._v(" query later.")]),t._v(" "),s("code-block",{staticClass:"codeblock",attrs:{language:"rust",base64:"I1tkZXJpdmUoU2VyaWFsaXplLCBEZXNlcmlhbGl6ZSwgQ2xvbmUsIERlYnVnLCBQYXJ0aWFsRXEsIEpzb25TY2hlbWEpXQojW3NlcmRlKHJlbmFtZV9hbGwgPSAmcXVvdDtzbmFrZV9jYXNlJnF1b3Q7KV0KcHViIGVudW0gUXVlcnlNc2cgewogICAgQ29uZmlnIHt9LAp9Cg=="}}),t._v(" "),s("h2",{attrs:{id:"state"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#state"}},[t._v("#")]),t._v(" State")]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",[t._v("Timecode "),s("a",{attrs:{href:"https://vimeo.com/457702442#t=7m36s",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://vimeo.com/457702442#t=7m36s"),s("OutboundLink")],1)])]),t._v(" "),s("p",[s("a",{attrs:{href:"https://github.com/CosmWasm/cosmwasm-examples/blob/master/simple-option/src/state.rs",target:"_blank",rel:"noopener noreferrer"}},[t._v("State"),s("OutboundLink")],1),t._v(" handles state of the database where smart contract data is stored and accessed.")]),t._v(" "),s("p",[t._v("You have two options when modeling state:")]),t._v(" "),s("ol",[s("li",[s("strong",[t._v("Singleton")]),t._v(": contract saves only one instance of the structure using unique db key. We will use this in this tutorial.")]),t._v(" "),s("li",[s("strong",[t._v("Structured store")]),t._v(": models can be structured and stored dynamically. You can form one-to-one, one-to-many and many-to-many relations with indexing and lookup functionality.")])]),t._v(" "),s("code-block",{staticClass:"codeblock",attrs:{language:"rust",base64:"Ly8gY29uZmlndXJhdGlvbiBpbnN0YW5jZSBrZXkuIGNvbmZpZyBvYmplY3Qgd2lsbCBiZSBzYXZlZCB1bmRlciB0aGlzIGtleS4KcHViIHN0YXRpYyBDT05GSUdfS0VZOiAmYW1wO1t1OF0gPSBiJnF1b3Q7Y29uZmlnJnF1b3Q7OwoKLy8gY29udHJhY3Qgc3RhdGUgc3RydWN0dXJlLCB0aGlzIHdpbGwgYmUgc2F2ZWQuCiNbZGVyaXZlKFNlcmlhbGl6ZSwgRGVzZXJpYWxpemUsIENsb25lLCBEZWJ1ZywgUGFydGlhbEVxLCBKc29uU2NoZW1hKV0KcHViIHN0cnVjdCBTdGF0ZSB7CiAgICBwdWIgY3JlYXRvcjogSHVtYW5BZGRyLAogICAgcHViIG93bmVyOiBIdW1hbkFkZHIsCiAgICBwdWIgY29sbGF0ZXJhbDogVmVjJmx0O0NvaW4mZ3Q7LAogICAgcHViIGNvdW50ZXJfb2ZmZXI6IFZlYyZsdDtDb2luJmd0OywKICAgIHB1YiBleHBpcmVzOiB1NjQsCn0KCi8vIHJldHVybnMgYSBidWNrZXQgdG8gcmVhZC93cml0ZSB0byBzdG9yZS4KcHViIGZuIGNvbmZpZyZsdDtTOiBTdG9yYWdlJmd0OyhzdG9yYWdlOiAmYW1wO211dCBTKSAtJmd0OyBTaW5nbGV0b24mbHQ7UywgU3RhdGUmZ3Q7IHsKICAgIHNpbmdsZXRvbihzdG9yYWdlLCBDT05GSUdfS0VZKQp9CgovLyByZXR1cm5zIGEgcmVhZG9ubHkgYnVja2V0IG9ubHkgcmVhZCBzdG9yZS4KLy8gU2FmZXIgdG8gdXNlIHJlYWRfb25seSB3aGVuIG5vIG5lZWQgdG8gd3JpdGUgbGlrZSBxdWVyeWluZy4KcHViIGZuIGNvbmZpZ19yZWFkJmx0O1M6IFN0b3JhZ2UmZ3Q7KHN0b3JhZ2U6ICZhbXA7UykgLSZndDsgUmVhZG9ubHlTaW5nbGV0b24mbHQ7UywgU3RhdGUmZ3Q7IHsKICAgIHNpbmdsZXRvbl9yZWFkKHN0b3JhZ2UsIENPTkZJR19LRVkpCn0KCi8vIHRoaXMgaXMgb3B0aW9uYWwuCi8vIENvbmZpZ1Jlc3BvbnNlIGFzIHJldHVybmVkIGFzIHJlc3BvbnNlIHN0cnVjdHVyZSB0byBxdWVyeV9jb25maWcuCi8vIGdvb2QgdG8gaGF2ZSBhbGlhc2luZy4KcHViIHR5cGUgQ29uZmlnUmVzcG9uc2UgPSBTdGF0ZTsK"}}),t._v(" "),s("h2",{attrs:{id:"contract-handlers"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#contract-handlers"}},[t._v("#")]),t._v(" Contract Handlers")]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",[t._v("Timecode "),s("a",{attrs:{href:"https://vimeo.com/457702442#t=11m12s",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://vimeo.com/457702442#t=11m12s"),s("OutboundLink")],1)])]),t._v(" "),s("p",[t._v("Lego bricks "),s("strong",[t._v("msgs")]),t._v(", "),s("strong",[t._v("handler")]),t._v(" and "),s("strong",[t._v("state")]),t._v(" are defined. Now we need to bind them together in "),s("a",{attrs:{href:"https://github.com/CosmWasm/cosmwasm-examples/blob/master/simple-option/src/contract.rs",target:"_blank",rel:"noopener noreferrer"}},[t._v("contract.rs"),s("OutboundLink")],1),t._v(".")]),t._v(" "),s("h3",{attrs:{id:"init"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#init"}},[t._v("#")]),t._v(" Init")]),t._v(" "),s("p",[t._v('The init function will be called exactly once, before the contract is executed. It is a "privileged" function in that it can set configuration that can never be modified by any other method call.\nthe first line parses the input from raw bytes into our contract-defined message. We then check if option is expired, then create the initial state. If expired, we return a generic contract error, otherwise, we store the state and return a success code:')]),t._v(" "),s("code-block",{staticClass:"codeblock",attrs:{language:"rust",base64:"cHViIGZuIGluaXQmbHQ7UzogU3RvcmFnZSwgQTogQXBpLCBROiBRdWVyaWVyJmd0OygKICAgIGRlcHM6ICZhbXA7bXV0IEV4dGVybiZsdDtTLCBBLCBRJmd0OywKICAgIGVudjogRW52LAogICAgbXNnOiBJbml0TXNnLAopIC0mZ3Q7IFN0ZFJlc3VsdCZsdDtJbml0UmVzcG9uc2UmZ3Q7IHsKICAgIGlmIG1zZy5leHBpcmVzICZsdDs9IGVudi5ibG9jay5oZWlnaHQgewogICAgICAgIHJldHVybiBFcnIoU3RkRXJyb3I6OmdlbmVyaWNfZXJyKCZxdW90O0Nhbm5vdCBjcmVhdGUgZXhwaXJlZCBvcHRpb24mcXVvdDspKTsKICAgIH0KCiAgICBsZXQgc3RhdGUgPSBTdGF0ZSB7CiAgICAgICAgY3JlYXRvcjogZW52Lm1lc3NhZ2Uuc2VuZGVyLmNsb25lKCksCiAgICAgICAgb3duZXI6IGVudi5tZXNzYWdlLnNlbmRlci5jbG9uZSgpLAogICAgICAgIGNvbGxhdGVyYWw6IGVudi5tZXNzYWdlLnNlbnRfZnVuZHMsCiAgICAgICAgY291bnRlcl9vZmZlcjogbXNnLmNvdW50ZXJfb2ZmZXIsCiAgICAgICAgZXhwaXJlczogbXNnLmV4cGlyZXMsCiAgICB9OwoKICAgIGNvbmZpZygmYW1wO211dCBkZXBzLnN0b3JhZ2UpLnNhdmUoJmFtcDtzdGF0ZSk/OwoKICAgIE9rKEluaXRSZXNwb25zZTo6ZGVmYXVsdCgpKQp9Cg=="}}),t._v(" "),s("p",[t._v("The function is simple as it looks. Option expiration date check, save the state, and return response.")]),t._v(" "),s("code-block",{staticClass:"codeblock",attrs:{language:"rust",base64:"cHViIGZuIGluaXQmbHQ7UzogU3RvcmFnZSwgQTogQXBpLCBROiBRdWVyaWVyJmd0OygKICAgIGRlcHM6ICZhbXA7bXV0IEV4dGVybiZsdDtTLCBBLCBRJmd0OywKICAgIGVudjogRW52LAogICAgbXNnOiBJbml0TXNnLAopIC0mZ3Q7IFN0ZFJlc3VsdCZsdDtJbml0UmVzcG9uc2UmZ3Q7Cg=="}}),t._v(" "),s("p",[t._v("You will see this signature all over CosmWasm handler functions. Execution context passed in to handler using Deps, which contains Storage, API and Querier functions; Env, which contains block, message and contract info; and msg, well, no explanation needed.")]),t._v(" "),s("p",[s("code",[t._v("StdResult<T>")]),t._v(" is a type that represents either success (["),s("code",[t._v("Ok")]),t._v("]) or failure (["),s("code",[t._v("Err")]),t._v("]). If the execution is successful returns "),s("code",[t._v("T")]),t._v(" type otherwise returns "),s("code",[t._v("StdError")]),t._v(". Useful.")]),t._v(" "),s("h3",{attrs:{id:"handle"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#handle"}},[t._v("#")]),t._v(" Handle")]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",[t._v("Timecode "),s("a",{attrs:{href:"https://vimeo.com/457702442#t=15m55s",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://vimeo.com/457702442#t=15m55s"),s("OutboundLink")],1)])]),t._v(" "),s("p",[s("code",[t._v("handle")]),t._v(" method routes messages to functions. It is similar to Cosmos SDK handler design.")]),t._v(" "),s("code-block",{staticClass:"codeblock",attrs:{language:"rust",base64:"cHViIGZuIGhhbmRsZSZsdDtTOiBTdG9yYWdlLCBBOiBBcGksIFE6IFF1ZXJpZXImZ3Q7KAogICAgZGVwczogJmFtcDttdXQgRXh0ZXJuJmx0O1MsIEEsIFEmZ3Q7LAogICAgZW52OiBFbnYsCiAgICBtc2c6IEhhbmRsZU1zZywKKSAtJmd0OyBTdGRSZXN1bHQmbHQ7SGFuZGxlUmVzcG9uc2UmZ3Q7IHsKICAgIG1hdGNoIG1zZyB7CiAgICAgICAgSGFuZGxlTXNnOjpUcmFuc2ZlciB7IHJlY2lwaWVudCB9ID0mZ3Q7IGhhbmRsZV90cmFuc2ZlcihkZXBzLCBlbnYsIHJlY2lwaWVudCksCiAgICAgICAgSGFuZGxlTXNnOjpFeGVjdXRlIHt9ID0mZ3Q7IGhhbmRsZV9leGVjdXRlKGRlcHMsIGVudiksCiAgICAgICAgSGFuZGxlTXNnOjpCdXJuIHt9ID0mZ3Q7IGhhbmRsZV9idXJuKGRlcHMsIGVudiksCiAgICB9Cn0K"}}),t._v(" "),s("h4",{attrs:{id:"transfer"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#transfer"}},[t._v("#")]),t._v(" Transfer")]),t._v(" "),s("code-block",{staticClass:"codeblock",attrs:{language:"rust",base64:"cHViIGZuIGhhbmRsZV90cmFuc2ZlciZsdDtTOiBTdG9yYWdlLCBBOiBBcGksIFE6IFF1ZXJpZXImZ3Q7KAogICAgZGVwczogJmFtcDttdXQgRXh0ZXJuJmx0O1MsIEEsIFEmZ3Q7LAogICAgZW52OiBFbnYsCiAgICByZWNpcGllbnQ6IEh1bWFuQWRkciwKKSAtJmd0OyBTdGRSZXN1bHQmbHQ7SGFuZGxlUmVzcG9uc2UmZ3Q7IHsKICAgIC8vIGVuc3VyZSBtc2cgc2VuZGVyIGlzIHRoZSBvd25lcgogICAgbGV0IG11dCBzdGF0ZSA9IGNvbmZpZygmYW1wO211dCBkZXBzLnN0b3JhZ2UpLmxvYWQoKT87CiAgICAvKgogICAgICogUXVlc3Rpb24gKD8pIG1hcmsgYXQgdGhlIGVuZCBpcyBhIHN5bnRhY3RpYyBzdWdhci4KICAgICAqIElmIHRoZSByZXN1bHQgb2YgbG9hZCBpcyBhbiBlcnJvciwgcmV0dXJuIHRoZSBlcnJvci4KICAgICAqIE90aGVyd2lzZSBzZXQgdGhlIHN0YXRlIHRvIHRoZSByZXR1cm5lZCB2YWx1ZS4KICAgICAqLwogICAgaWYgZW52Lm1lc3NhZ2Uuc2VuZGVyICE9IHN0YXRlLm93bmVyIHsKICAgICAgICByZXR1cm4gRXJyKFN0ZEVycm9yOjp1bmF1dGhvcml6ZWQoKSk7CiAgICB9CgogICAgLy8gc2V0IG5ldyBvd25lciBvbiBzdGF0ZQogICAgc3RhdGUub3duZXIgPSByZWNpcGllbnQuY2xvbmUoKTsKICAgIGNvbmZpZygmYW1wO211dCBkZXBzLnN0b3JhZ2UpLnNhdmUoJmFtcDtzdGF0ZSk/OwoKICAgIGxldCBtdXQgcmVzID0gQ29udGV4dDo6bmV3KCk7CiAgICByZXMuYWRkX2xvZygmcXVvdDthY3Rpb24mcXVvdDssICZxdW90O3RyYW5zZmVyJnF1b3Q7KTsKICAgIHJlcy5hZGRfbG9nKCZxdW90O293bmVyJnF1b3Q7LCByZWNpcGllbnQpOwogICAgLyoKICAgICAqIGxvZ3Mgd2lsbCBnbyB0byB0aGUgY29zbW9zIHNkayBldmVudCBsb2cuCiAgICAgKi8KICAgIE9rKHJlcy5pbnRvKCkpCiAgICAvKgogICAgICogcmVzLmludG8gY29udmVydHMgQ29udGV4dCB0byBIYW5kbGVSZXNwb25zZS4KICAgICAqLwp9Cg=="}}),t._v(" "),s("h4",{attrs:{id:"execute"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#execute"}},[t._v("#")]),t._v(" Execute")]),t._v(" "),s("p",[t._v("You will see "),s("code",[t._v("handle_execute")]),t._v(" in plus and example smart contracts, but actually it is just a naming, nothing special.\nMost of the function is same with "),s("code",[t._v("transfer")]),t._v(". Just two new things: message fund check and sdk messages in return context.")]),t._v(" "),s("code-block",{staticClass:"codeblock",attrs:{language:"rust",base64:"cHViIGZuIGhhbmRsZV9leGVjdXRlJmx0O1M6IFN0b3JhZ2UsIEE6IEFwaSwgUTogUXVlcmllciZndDsoCiAgICBkZXBzOiAmYW1wO211dCBFeHRlcm4mbHQ7UywgQSwgUSZndDssCiAgICBlbnY6IEVudiwKKSAtJmd0OyBTdGRSZXN1bHQmbHQ7SGFuZGxlUmVzcG9uc2UmZ3Q7IHsKICAgIC8vIGVuc3VyZSBtc2cgc2VuZGVyIGlzIHRoZSBvd25lcgogICAgbGV0IHN0YXRlID0gY29uZmlnKCZhbXA7bXV0IGRlcHMuc3RvcmFnZSkubG9hZCgpPzsKICAgIGlmIGVudi5tZXNzYWdlLnNlbmRlciAhPSBzdGF0ZS5vd25lciB7CiAgICAgICAgcmV0dXJuIEVycihTdGRFcnJvcjo6dW5hdXRob3JpemVkKCkpOwogICAgfQoKICAgIC8vIGVuc3VyZSBub3QgZXhwaXJlZAogICAgaWYgZW52LmJsb2NrLmhlaWdodCAmZ3Q7PSBzdGF0ZS5leHBpcmVzIHsKICAgICAgICByZXR1cm4gRXJyKFN0ZEVycm9yOjpnZW5lcmljX2VycigmcXVvdDtvcHRpb24gZXhwaXJlZCZxdW90OykpOwogICAgfQoKICAgIC8qCiAgICAgKiBlbnYubWVzc2FnZS5zZW50X2Z1bmRzIGlzIHRoZSBjb2lucyBzZW50IGFsb25nIHRoZSB0eC4KICAgICAqLwogICAgLy8gZW5zdXJlIHNlbmRpbmcgcHJvcGVyIGNvdW50ZXJfb2ZmZXIKICAgIGlmIGVudi5tZXNzYWdlLnNlbnRfZnVuZHMgIT0gc3RhdGUuY291bnRlcl9vZmZlciB7CiAgICAgICAgcmV0dXJuIEVycihTdGRFcnJvcjo6Z2VuZXJpY19lcnIoZm9ybWF0ISgKICAgICAgICAgICAgJnF1b3Q7bXVzdCBzZW5kIGV4YWN0IGNvdW50ZXIgb2ZmZXI6IHs6P30mcXVvdDssCiAgICAgICAgICAgIHN0YXRlLmNvdW50ZXJfb2ZmZXIKICAgICAgICApKSk7CiAgICB9CgogICAgLy8gcmVsZWFzZSBjb3VudGVyX29mZmVyIHRvIGNyZWF0b3IKICAgIGxldCBtdXQgcmVzID0gQ29udGV4dDo6bmV3KCk7CgogICAgLyoKICAgICAqIENvc21XYXNtIHNtYXJ0IGNvbnRyYWN0IGNhbm5vdCBleGVjdXRlIG5hdGl2ZSBDb3Ntb3MgU0RLIG1lc3NhZ2VzCiAgICAgKiBzdWNoIGFzIGJhbmsgc2VuZCBtc2cuIEluc3RlYWQgd2UgcmV0dXJuIG5hdGl2ZSBtZXNzYWdlcyBpbiB0aGUgZXhlY3V0aW9uIGNvbnRleHQKICAgICAqIHRvIGJlIHByb2Nlc3NlZCBieSBDb3Ntb3MgU0RLIHRyYW5zYWN0aW9uIHJ1bnRpbWUuCiAgICAgKi8KICAgIHJlcy5hZGRfbWVzc2FnZShCYW5rTXNnOjpTZW5kIHsKICAgICAgICBmcm9tX2FkZHJlc3M6IGVudi5jb250cmFjdC5hZGRyZXNzLmNsb25lKCksCiAgICAgICAgdG9fYWRkcmVzczogc3RhdGUuY3JlYXRvciwKICAgICAgICBhbW91bnQ6IHN0YXRlLmNvdW50ZXJfb2ZmZXIsCiAgICB9KTsKCiAgICAvLyByZWxlYXNlIGNvbGxhdGVyYWwgdG8gc2VuZGVyCiAgICByZXMuYWRkX21lc3NhZ2UoQmFua01zZzo6U2VuZCB7CiAgICAgICAgZnJvbV9hZGRyZXNzOiBlbnYuY29udHJhY3QuYWRkcmVzcywKICAgICAgICB0b19hZGRyZXNzOiBzdGF0ZS5vd25lciwKICAgICAgICBhbW91bnQ6IHN0YXRlLmNvbGxhdGVyYWwsCiAgICB9KTsKCiAgICAvLyBkZWxldGUgdGhlIG9wdGlvbgogICAgY29uZmlnKCZhbXA7bXV0IGRlcHMuc3RvcmFnZSkucmVtb3ZlKCk7CgogICAgcmVzLmFkZF9sb2coJnF1b3Q7YWN0aW9uJnF1b3Q7LCAmcXVvdDtleGVjdXRlJnF1b3Q7KTsKICAgIE9rKHJlcy5pbnRvKCkpCn0K"}}),t._v(" "),s("h3",{attrs:{id:"query"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#query"}},[t._v("#")]),t._v(" Query")]),t._v(" "),s("p",[t._v("This contracts query method is very simple, only configuration query.\nFor more complex queries check "),s("a",{attrs:{href:"https://github.com/CosmWasm/cosmwasm-plus/",target:"_blank",rel:"noopener noreferrer"}},[t._v("cosmwasm-plus"),s("OutboundLink")],1),t._v(" contracts.\nIf you are starting to learn from zero, now you have 20 minutes of cosmwasm experience. Go ahead skim plus contracts to see the simplicity.")]),t._v(" "),s("code-block",{staticClass:"codeblock",attrs:{language:"rust",base64:"cHViIGZuIHF1ZXJ5Jmx0O1M6IFN0b3JhZ2UsIEE6IEFwaSwgUTogUXVlcmllciZndDsoCiAgICBkZXBzOiAmYW1wO0V4dGVybiZsdDtTLCBBLCBRJmd0OywKICAgIG1zZzogUXVlcnlNc2csCikgLSZndDsgU3RkUmVzdWx0Jmx0O0JpbmFyeSZndDsgewogICAgbWF0Y2ggbXNnIHsKICAgICAgICAvKgogICAgICAgICAqIENsaWVudCB3aWxsIHBhcnNlIGJpbmFyeQogICAgICAgICAqLwogICAgICAgIFF1ZXJ5TXNnOjpDb25maWcge30gPSZndDsgdG9fYmluYXJ5KCZhbXA7cXVlcnlfY29uZmlnKGRlcHMpPyksCiAgICB9Cn0KCmZuIHF1ZXJ5X2NvbmZpZyZsdDtTOiBTdG9yYWdlLCBBOiBBcGksIFE6IFF1ZXJpZXImZ3Q7KAogICAgZGVwczogJmFtcDtFeHRlcm4mbHQ7UywgQSwgUSZndDssCikgLSZndDsgU3RkUmVzdWx0Jmx0O0NvbmZpZ1Jlc3BvbnNlJmd0OyB7CiAgICBsZXQgc3RhdGUgPSBjb25maWdfcmVhZCgmYW1wO2RlcHMuc3RvcmFnZSkubG9hZCgpPzsKICAgIE9rKHN0YXRlKQp9Cg=="}}),t._v(" "),s("h3",{attrs:{id:"build"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#build"}},[t._v("#")]),t._v(" Build")]),t._v(" "),s("p",[t._v("To simply build the code and see if it works:")]),t._v(" "),s("code-block",{staticClass:"codeblock",attrs:{language:"shell",base64:"Y2FyZ28gYnVpbGQK"}}),t._v(" "),s("h3",{attrs:{id:"tooling"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#tooling"}},[t._v("#")]),t._v(" Tooling")]),t._v(" "),s("p",[t._v("It is good to keep the same coding style across smart contracts for readability and lint it for high code quality:")]),t._v(" "),s("code-block",{staticClass:"codeblock",attrs:{language:"shell",base64:"cnVzdHVwIHVwZGF0ZQpydXN0dXAgY29tcG9uZW50IGFkZCBjbGlwcHkgcnVzdGZtdAo="}}),t._v(" "),s("code-block",{staticClass:"codeblock",attrs:{language:"shell",base64:"Y2FyZ28gZm10Cg=="}}),t._v(" "),s("p",[t._v("Normally Rust compiler does its job great, leads you to the solution for the errors, shows warnings etc.\nBut it is always good to run linter on the code.")]),t._v(" "),s("code-block",{staticClass:"codeblock",attrs:{language:"shell",base64:"Y2FyZ28gY2xpcHB5IC0tIC1EIHdhcm5pbmdzCg=="}}),t._v(" "),s("h3",{attrs:{id:"compile"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#compile"}},[t._v("#")]),t._v(" Compile")]),t._v(" "),s("p",[t._v("This section compiles key commands from "),s("a",{attrs:{href:"https://docs.cosmwasm.com/getting-started/compile-contract.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Compiling Contract"),s("OutboundLink")],1),t._v(" doc. For more detailed read proceed to the documentation.")]),t._v(" "),s("p",[t._v("Basic compilation:")]),t._v(" "),s("code-block",{staticClass:"codeblock",attrs:{language:"shell",base64:"Y2FyZ28gd2FzbQo="}}),t._v(" "),s("p",[t._v("Optimized compilation:")]),t._v(" "),s("code-block",{staticClass:"codeblock",attrs:{language:"shell",base64:"UlVTVEZMQUdTPSctQyBsaW5rLWFyZz0tcycgY2FyZ28gd2FzbQo="}}),t._v(" "),s("p",[t._v("Reproducible and optimized compilation:")]),t._v(" "),s("code-block",{staticClass:"codeblock",attrs:{language:"shell",base64:"ZG9ja2VyIHJ1biAtLXJtIC12ICZxdW90OyQocHdkKSZxdW90OzovY29kZSBcCiAgLS1tb3VudCB0eXBlPXZvbHVtZSxzb3VyY2U9JnF1b3Q7JChiYXNlbmFtZSAmcXVvdDskKHB3ZCkmcXVvdDspX2NhY2hlJnF1b3Q7LHRhcmdldD0vY29kZS90YXJnZXQgXAogIC0tbW91bnQgdHlwZT12b2x1bWUsc291cmNlPXJlZ2lzdHJ5X2NhY2hlLHRhcmdldD0vdXNyL2xvY2FsL2NhcmdvL3JlZ2lzdHJ5IFwKICBjb3Ntd2FzbS9ydXN0LW9wdGltaXplcjowLjEwLjMK"}}),t._v(" "),s("p",[t._v("You want to use the command above before deploying to the chain.")]),t._v(" "),s("h3",{attrs:{id:"schema"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#schema"}},[t._v("#")]),t._v(" Schema")]),t._v(" "),s("p",[t._v('We can also generate JSON Schemas that serve as a guide for anyone trying to use the contract. This is mainly for documentation purposes, but if you click on "Open TypeScript definitions" in the code explorer, you can see how we use those to generate TypeScript bindings.')]),t._v(" "),s("code-block",{staticClass:"codeblock",attrs:{language:"shell",base64:"Y2FyZ28gc2NoZW1hCg=="}}),t._v(" "),s("p",[t._v("You can see the generated schemas under "),s("a",{attrs:{href:"https://github.com/CosmWasm/cosmwasm-examples/tree/master/simple-option/schema",target:"_blank",rel:"noopener noreferrer"}},[t._v("simple-option/schema"),s("OutboundLink")],1)]),t._v(" "),s("code-block",{staticClass:"codeblock",attrs:{language:"",base64:"c2NoZW1hCuKUnOKUgOKUgCBjb25maWdfcmVzcG9uc2UuanNvbgrilJzilIDilIAgaGFuZGxlX21zZy5qc29uCuKUnOKUgOKUgCBpbml0X21zZy5qc29uCuKUlOKUgOKUgCBxdWVyeV9tc2cuanNvbgo="}}),t._v(" "),s("p",[t._v("Go ahead and explore schemas.")])],1)}),[],!1,null,null,null);e.default=c.exports}}]);