(window.webpackJsonp=window.webpackJsonp||[]).push([[112],{711:function(g,C,I){"use strict";I.r(C);var c=I(0),t=Object(c.a)({},(function(){var g=this,C=g.$createElement,I=g._self._c||C;return I("ContentSlotsDistributor",{attrs:{"slot-key":g.$parent.slotKey}},[I("h1",{attrs:{id:"testing"}},[I("a",{staticClass:"header-anchor",attrs:{href:"#testing"}},[g._v("#")]),g._v(" Testing")]),g._v(" "),I("iframe",{attrs:{src:"https://player.vimeo.com/video/457705991",width:"640",height:"360",frameborder:"0",allow:"autoplay; fullscreen",allowfullscreen:""}}),g._v(" "),I("p",[g._v("At this point your code should be compiling, although we did not test if it works.\nYou can deploy the code to the chain everytime when you make a change. But come on, your time is more valuable than that.\nAlso, good to keep the contract break-free and tested for future changes.")]),g._v(" "),I("tm-code-block",{staticClass:"codeblock",attrs:{language:"rust",base64:"I1tjZmcodGVzdCldCm1vZCB0ZXN0cyB7CiAgICB1c2Ugc3VwZXI6Oio7CiAgICB1c2UgY29zbXdhc21fc3RkOjp0ZXN0aW5nOjp7bW9ja19kZXBlbmRlbmNpZXMsIG1vY2tfZW52LCBtb2NrX2luZm8sIE1PQ0tfQ09OVFJBQ1RfQUREUn07CiAgICB1c2UgY29zbXdhc21fc3RkOjp7YXR0ciwgY29pbnMsIENvc21vc01zZ307Cg=="}}),g._v(" "),I("p",[g._v("This is how testing in Rust begins. "),I("a",{attrs:{href:"https://github.com/CosmWasm/cosmwasm-examples/blob/master/simple-option/src/contract.rs",target:"_blank",rel:"noopener noreferrer"}},[g._v("Code reference"),I("OutboundLink")],1),g._v(".\nYou can keep test and code in the same or separate files.")]),g._v(" "),I("h2",{attrs:{id:"test-initialization"}},[I("a",{staticClass:"header-anchor",attrs:{href:"#test-initialization"}},[g._v("#")]),g._v(" Test Initialization")]),g._v(" "),I("div",{staticClass:"custom-block tip"},[I("p",[g._v("Timecode "),I("a",{attrs:{href:"https://vimeo.com/457705991#t=3m34s",target:"_blank",rel:"noopener noreferrer"}},[g._v("https://vimeo.com/457705991#t=3m34s"),I("OutboundLink")],1)])]),g._v(" "),I("p",[g._v("For each test, test specific variables such as block time, state must be mocked. Write a function for easy setup.")]),g._v(" "),I("tm-code-block",{staticClass:"codeblock",attrs:{language:"rust",base64:"I1t0ZXN0XQpmbiBwcm9wZXJfaW5pdGlhbGl6YXRpb24oKSB7CiAgICBsZXQgbXV0IGRlcHMgPSBtb2NrX2RlcGVuZGVuY2llcygmYW1wO1tdKTsKCiAgICBsZXQgbXNnID0gSW5pdE1zZyB7CiAgICAgICAgY291bnRlcl9vZmZlcjogY29pbnMoNDAsICZxdW90O0VUSCZxdW90OyksCiAgICAgICAgZXhwaXJlczogMTAwXzAwMCwKICAgIH07CiAgICBsZXQgaW5mbyA9IG1vY2tfaW5mbygmcXVvdDtjcmVhdG9yJnF1b3Q7LCAmYW1wO2NvaW5zKDEsICZxdW90O0JUQyZxdW90OykpOwoKICAgIC8vIHdlIGNhbiBqdXN0IGNhbGwgLnVud3JhcCgpIHRvIGFzc2VydCB0aGlzIHdhcyBhIHN1Y2Nlc3MKICAgIGxldCByZXMgPSBpbml0KGRlcHMuYXNfbXV0KCksIG1vY2tfZW52KCksIGluZm8sIG1zZykudW53cmFwKCk7CiAgICBhc3NlcnRfZXEhKDAsIHJlcy5tZXNzYWdlcy5sZW4oKSk7CgogICAgLy8gaXQgd29ya2VkLCBsZXQncyBxdWVyeSB0aGUgc3RhdGUKICAgIGxldCByZXMgPSBxdWVyeV9jb25maWcoZGVwcy5hc19yZWYoKSkudW53cmFwKCk7CiAgICBhc3NlcnRfZXEhKDEwMF8wMDAsIHJlcy5leHBpcmVzKTsKICAgIGFzc2VydF9lcSEoJnF1b3Q7Y3JlYXRvciZxdW90OywgcmVzLm93bmVyLmFzX3N0cigpKTsKICAgIGFzc2VydF9lcSEoJnF1b3Q7Y3JlYXRvciZxdW90OywgcmVzLmNyZWF0b3IuYXNfc3RyKCkpOwogICAgYXNzZXJ0X2VxIShjb2lucygxLCAmcXVvdDtCVEMmcXVvdDspLCByZXMuY29sbGF0ZXJhbCk7CiAgICBhc3NlcnRfZXEhKGNvaW5zKDQwLCAmcXVvdDtFVEgmcXVvdDspLCByZXMuY291bnRlcl9vZmZlcik7Cn0K"}}),g._v(" "),I("p",[g._v("Good we now have a test environment initializer. This is a very simple one, you can pass in variables to the function and do different tweaks.\nCheck cosmwasm-plus for more.")]),g._v(" "),I("h3",{attrs:{id:"mock-dependencies-environment-and-message-info"}},[I("a",{staticClass:"header-anchor",attrs:{href:"#mock-dependencies-environment-and-message-info"}},[g._v("#")]),g._v(" Mock Dependencies, Environment, and Message Info")]),g._v(" "),I("p",[g._v("There are two three mocking tools we should improve on:")]),g._v(" "),I("tm-code-block",{staticClass:"codeblock",attrs:{language:"rust",base64:"Ly8vIEFsbCBleHRlcm5hbCByZXF1aXJlbWVudHMgdGhhdCBjYW4gYmUgaW5qZWN0ZWQgZm9yIHVuaXQgdGVzdHMuCi8vLyBJdCBzZXRzIHRoZSBnaXZlbiBiYWxhbmNlIGZvciB0aGUgY29udHJhY3QgaXRzZWxmLCBub3RoaW5nIGVsc2UKcHViIGZuIG1vY2tfZGVwZW5kZW5jaWVzKAogICAgY29udHJhY3RfYmFsYW5jZTogJmFtcDtbQ29pbl0sCikgLSZndDsgT3duZWREZXBzJmx0O01vY2tTdG9yYWdlLCBNb2NrQXBpLCBNb2NrUXVlcmllciZndDsgewogICAgbGV0IGNvbnRyYWN0X2FkZHIgPSBIdW1hbkFkZHI6OmZyb20oTU9DS19DT05UUkFDVF9BRERSKTsKICAgIE93bmVkRGVwcyB7CiAgICAgICAgc3RvcmFnZTogTW9ja1N0b3JhZ2U6OmRlZmF1bHQoKSwKICAgICAgICBhcGk6IE1vY2tBcGk6OmRlZmF1bHQoKSwKICAgICAgICBxdWVyaWVyOiBNb2NrUXVlcmllcjo6bmV3KCZhbXA7WygmYW1wO2NvbnRyYWN0X2FkZHIsIGNvbnRyYWN0X2JhbGFuY2UpXSksCiAgICB9Cn0K"}}),g._v(" "),I("p",[g._v("This sets up dependencies for testing such as storage, api, and querier.")]),g._v(" "),I("tm-code-block",{staticClass:"codeblock",attrs:{language:"rust",base64:"Ly8vIFJldHVybnMgYSBkZWZhdWx0IGVudmlyb21lbnQgd2l0aCBoZWlnaHQsIHRpbWUsIGNoYWluX2lkLCBhbmQgY29udHJhY3QgYWRkcmVzcwovLy8gWW91IGNhbiBzdWJtaXQgYXMgaXMgdG8gbW9zdCBjb250cmFjdHMsIG9yIG1vZGlmeSBoZWlnaHQvdGltZSBpZiB5b3Ugd2FudCB0bwovLy8gdGVzdCBmb3IgZXhwaXJhdGlvbi4KLy8vCi8vLyBUaGlzIGlzIGludGVuZGVkIGZvciB1c2UgaW4gdGVzdCBjb2RlIG9ubHkuCnB1YiBmbiBtb2NrX2VudigpIC0mZ3Q7IEVudiB7CiAgICBFbnYgewogICAgICAgIGJsb2NrOiBCbG9ja0luZm8gewogICAgICAgICAgICBoZWlnaHQ6IDEyXzM0NSwKICAgICAgICAgICAgdGltZTogMV81NzFfNzk3XzQxOSwKICAgICAgICAgICAgdGltZV9uYW5vczogODc5MzA1NTMzLAogICAgICAgICAgICBjaGFpbl9pZDogJnF1b3Q7Y29zbW9zLXRlc3RuZXQtMTQwMDImcXVvdDsudG9fc3RyaW5nKCksCiAgICAgICAgfSwKICAgICAgICBjb250cmFjdDogQ29udHJhY3RJbmZvIHsKICAgICAgICAgICAgYWRkcmVzczogSHVtYW5BZGRyOjpmcm9tKE1PQ0tfQ09OVFJBQ1RfQUREUiksCiAgICAgICAgfSwKICAgIH0KfQo="}}),g._v(" "),I("p",[I("code",[g._v("mock_env")]),g._v(" is for mocking block, and contract environment.")]),g._v(" "),I("tm-code-block",{staticClass:"codeblock",attrs:{language:"rust",base64:"Ly8vIEp1c3Qgc2V0IHNlbmRlciBhbmQgc2VudCBmdW5kcyBmb3IgdGhlIG1lc3NhZ2UuIFRoZSBlc3NlbnRpYWwgZm9yCi8vLyBUaGlzIGlzIGludGVuZGVkIGZvciB1c2UgaW4gdGVzdCBjb2RlIG9ubHkuCnB1YiBmbiBtb2NrX2luZm8mbHQ7VTogSW50byZsdDtIdW1hbkFkZHImZ3Q7Jmd0OyhzZW5kZXI6IFUsIHNlbnQ6ICZhbXA7W0NvaW5dKSAtJmd0OyBNZXNzYWdlSW5mbyB7CiAgICBNZXNzYWdlSW5mbyB7CiAgICAgICAgc2VuZGVyOiBzZW5kZXIuaW50bygpLAogICAgICAgIHNlbnRfZnVuZHM6IHNlbnQudG9fdmVjKCksCiAgICB9Cn0K"}}),g._v(" "),I("p",[I("code",[g._v("mock_info")]),g._v(" is for mocking transaction environment.")]),g._v(" "),I("h2",{attrs:{id:"test-handler"}},[I("a",{staticClass:"header-anchor",attrs:{href:"#test-handler"}},[g._v("#")]),g._v(" Test Handler")]),g._v(" "),I("div",{staticClass:"custom-block tip"},[I("p",[g._v("Timecode "),I("a",{attrs:{href:"https://vimeo.com/457705991#t=7m34s",target:"_blank",rel:"noopener noreferrer"}},[g._v("https://vimeo.com/457705991#t=7m34s"),I("OutboundLink")],1)])]),g._v(" "),I("h3",{attrs:{id:"test-transfer-handler"}},[I("a",{staticClass:"header-anchor",attrs:{href:"#test-transfer-handler"}},[g._v("#")]),g._v(" Test Transfer Handler")]),g._v(" "),I("tm-code-block",{staticClass:"codeblock",attrs:{language:"rust",base64:"I1t0ZXN0XQpmbiB0cmFuc2ZlcigpIHsKICAgIGxldCBtdXQgZGVwcyA9IG1vY2tfZGVwZW5kZW5jaWVzKCZhbXA7W10pOwoKICAgIGxldCBtc2cgPSBJbml0TXNnIHsKICAgICAgICBjb3VudGVyX29mZmVyOiBjb2lucyg0MCwgJnF1b3Q7RVRIJnF1b3Q7KSwKICAgICAgICBleHBpcmVzOiAxMDBfMDAwLAogICAgfTsKICAgIGxldCBpbmZvID0gbW9ja19pbmZvKCZxdW90O2NyZWF0b3ImcXVvdDssICZhbXA7Y29pbnMoMSwgJnF1b3Q7QlRDJnF1b3Q7KSk7CgogICAgLy8gd2UgY2FuIGp1c3QgY2FsbCAudW53cmFwKCkgdG8gYXNzZXJ0IHRoaXMgd2FzIGEgc3VjY2VzcwogICAgbGV0IHJlcyA9IGluaXQoZGVwcy5hc19tdXQoKSwgbW9ja19lbnYoKSwgaW5mbywgbXNnKS51bndyYXAoKTsKICAgIGFzc2VydF9lcSEoMCwgcmVzLm1lc3NhZ2VzLmxlbigpKTsKCiAgICAvLyByYW5kb20gY2Fubm90IHRyYW5zZmVyCiAgICBsZXQgaW5mbyA9IG1vY2tfaW5mbygmcXVvdDthbnlvbmUmcXVvdDssICZhbXA7W10pOwogICAgbGV0IGVyciA9IGhhbmRsZV90cmFuc2ZlcihkZXBzLmFzX211dCgpLCBtb2NrX2VudigpLCBpbmZvLCBIdW1hbkFkZHI6OmZyb20oJnF1b3Q7YW55b25lJnF1b3Q7KSkKICAgICAgICAudW53cmFwX2VycigpOwogICAgbWF0Y2ggZXJyIHsKICAgICAgICBDb250cmFjdEVycm9yOjpVbmF1dGhvcml6ZWQge30gPSZndDsge30KICAgICAgICBlID0mZ3Q7IHBhbmljISgmcXVvdDt1bmV4cGVjdGVkIGVycm9yOiB7fSZxdW90OywgZSksCiAgICB9CgogICAgLy8gb3duZXIgY2FuIHRyYW5zZmVyCiAgICBsZXQgaW5mbyA9IG1vY2tfaW5mbygmcXVvdDtjcmVhdG9yJnF1b3Q7LCAmYW1wO1tdKTsKICAgIGxldCByZXMgPQogICAgICAgIGhhbmRsZV90cmFuc2ZlcihkZXBzLmFzX211dCgpLCBtb2NrX2VudigpLCBpbmZvLCBIdW1hbkFkZHI6OmZyb20oJnF1b3Q7c29tZW9uZSZxdW90OykpLnVud3JhcCgpOwogICAgYXNzZXJ0X2VxIShyZXMuYXR0cmlidXRlcy5sZW4oKSwgMik7CiAgICBhc3NlcnRfZXEhKHJlcy5hdHRyaWJ1dGVzWzBdLCBhdHRyKCZxdW90O2FjdGlvbiZxdW90OywgJnF1b3Q7dHJhbnNmZXImcXVvdDspKTsKCiAgICAvLyBjaGVjayB1cGRhdGVkIHByb3Blcmx5CiAgICBsZXQgcmVzID0gcXVlcnlfY29uZmlnKGRlcHMuYXNfcmVmKCkpLnVud3JhcCgpOwogICAgYXNzZXJ0X2VxISgmcXVvdDtzb21lb25lJnF1b3Q7LCByZXMub3duZXIuYXNfc3RyKCkpOwogICAgYXNzZXJ0X2VxISgmcXVvdDtjcmVhdG9yJnF1b3Q7LCByZXMuY3JlYXRvci5hc19zdHIoKSk7Cn0K"}}),g._v(" "),I("h3",{attrs:{id:"test-execute"}},[I("a",{staticClass:"header-anchor",attrs:{href:"#test-execute"}},[g._v("#")]),g._v(" Test Execute")]),g._v(" "),I("div",{staticClass:"custom-block tip"},[I("p",[g._v("Timecode "),I("a",{attrs:{href:"https://vimeo.com/457705991#t=14m21s",target:"_blank",rel:"noopener noreferrer"}},[g._v("https://vimeo.com/457705991#t=14m21s"),I("OutboundLink")],1)])]),g._v(" "),I("tm-code-block",{staticClass:"codeblock",attrs:{language:"rust",base64:"I1t0ZXN0XQpmbiBleGVjdXRlKCkgewogICAgbGV0IG11dCBkZXBzID0gbW9ja19kZXBlbmRlbmNpZXMoJmFtcDtbXSk7CgogICAgbGV0IGFtb3VudCA9IGNvaW5zKDQwLCAmcXVvdDtFVEgmcXVvdDspOwogICAgbGV0IGNvbGxhdGVyYWwgPSBjb2lucygxLCAmcXVvdDtCVEMmcXVvdDspOwogICAgbGV0IGV4cGlyZXMgPSAxMDBfMDAwOwogICAgbGV0IG1zZyA9IEluaXRNc2cgewogICAgICAgIGNvdW50ZXJfb2ZmZXI6IGFtb3VudC5jbG9uZSgpLAogICAgICAgIGV4cGlyZXM6IGV4cGlyZXMsCiAgICB9OwogICAgbGV0IGluZm8gPSBtb2NrX2luZm8oJnF1b3Q7Y3JlYXRvciZxdW90OywgJmFtcDtjb2xsYXRlcmFsKTsKCiAgICAvLyB3ZSBjYW4ganVzdCBjYWxsIC51bndyYXAoKSB0byBhc3NlcnQgdGhpcyB3YXMgYSBzdWNjZXNzCiAgICBsZXQgXyA9IGluaXQoZGVwcy5hc19tdXQoKSwgbW9ja19lbnYoKSwgaW5mbywgbXNnKS51bndyYXAoKTsKCiAgICAvLyBzZXQgbmV3IG93bmVyCiAgICBsZXQgaW5mbyA9IG1vY2tfaW5mbygmcXVvdDtjcmVhdG9yJnF1b3Q7LCAmYW1wO1tdKTsKICAgIGxldCBfID0gaGFuZGxlX3RyYW5zZmVyKGRlcHMuYXNfbXV0KCksIG1vY2tfZW52KCksIGluZm8sIEh1bWFuQWRkcjo6ZnJvbSgmcXVvdDtvd25lciZxdW90OykpLnVud3JhcCgpOwoKICAgIC8vIHJhbmRvbSBjYW5ub3QgZXhlY3V0ZQogICAgbGV0IGluZm8gPSBtb2NrX2luZm8oJnF1b3Q7Y3JlYXRvciZxdW90OywgJmFtcDthbW91bnQpOwogICAgbGV0IGVyciA9IGhhbmRsZV9leGVjdXRlKGRlcHMuYXNfbXV0KCksIG1vY2tfZW52KCksIGluZm8pLnVud3JhcF9lcnIoKTsKICAgIG1hdGNoIGVyciB7CiAgICAgICAgQ29udHJhY3RFcnJvcjo6VW5hdXRob3JpemVkIHt9ID0mZ3Q7IHt9CiAgICAgICAgZSA9Jmd0OyBwYW5pYyEoJnF1b3Q7dW5leHBlY3RlZCBlcnJvcjoge30mcXVvdDssIGUpLAogICAgfQoKICAgIC8vIGV4cGlyZWQgY2Fubm90IGV4ZWN1dGUKICAgIGxldCBpbmZvID0gbW9ja19pbmZvKCZxdW90O293bmVyJnF1b3Q7LCAmYW1wO2Ftb3VudCk7CiAgICBsZXQgbXV0IGVudiA9IG1vY2tfZW52KCk7CiAgICBlbnYuYmxvY2suaGVpZ2h0ID0gMjAwXzAwMDsKICAgIGxldCBlcnIgPSBoYW5kbGVfZXhlY3V0ZShkZXBzLmFzX211dCgpLCBlbnYsIGluZm8pLnVud3JhcF9lcnIoKTsKICAgIG1hdGNoIGVyciB7CiAgICAgICAgQ29udHJhY3RFcnJvcjo6T3B0aW9uRXhwaXJlZCB7IGV4cGlyZWQgfSA9Jmd0OyBhc3NlcnRfZXEhKGV4cGlyZWQsIGV4cGlyZXMpLAogICAgICAgIGUgPSZndDsgcGFuaWMhKCZxdW90O3VuZXhwZWN0ZWQgZXJyb3I6IHt9JnF1b3Q7LCBlKSwKICAgIH0KCiAgICAvLyBiYWQgY291bnRlcl9vZmZlciBjYW5ub3QgZXhlY3V0ZQogICAgbGV0IG1zZ19vZmZlciA9IGNvaW5zKDM5LCAmcXVvdDtFVEgmcXVvdDspOwogICAgbGV0IGluZm8gPSBtb2NrX2luZm8oJnF1b3Q7b3duZXImcXVvdDssICZhbXA7bXNnX29mZmVyKTsKICAgIGxldCBlcnIgPSBoYW5kbGVfZXhlY3V0ZShkZXBzLmFzX211dCgpLCBtb2NrX2VudigpLCBpbmZvKS51bndyYXBfZXJyKCk7CiAgICBtYXRjaCBlcnIgewogICAgICAgIENvbnRyYWN0RXJyb3I6OkNvdW50ZXJPZmZlck1pc21hdGNoIHsKICAgICAgICAgICAgb2ZmZXIsCiAgICAgICAgICAgIGNvdW50ZXJfb2ZmZXIsCiAgICAgICAgfSA9Jmd0OyB7CiAgICAgICAgICAgIGFzc2VydF9lcSEobXNnX29mZmVyLCBvZmZlcik7CiAgICAgICAgICAgIGFzc2VydF9lcSEoYW1vdW50LCBjb3VudGVyX29mZmVyKTsKICAgICAgICB9CiAgICAgICAgZSA9Jmd0OyBwYW5pYyEoJnF1b3Q7dW5leHBlY3RlZCBlcnJvcjoge30mcXVvdDssIGUpLAogICAgfQoKICAgIC8vIHByb3BlciBleGVjdXRpb24KICAgIGxldCBpbmZvID0gbW9ja19pbmZvKCZxdW90O293bmVyJnF1b3Q7LCAmYW1wO2Ftb3VudCk7CiAgICBsZXQgcmVzID0gaGFuZGxlX2V4ZWN1dGUoZGVwcy5hc19tdXQoKSwgbW9ja19lbnYoKSwgaW5mbykudW53cmFwKCk7CiAgICBhc3NlcnRfZXEhKHJlcy5tZXNzYWdlcy5sZW4oKSwgMik7CiAgICBhc3NlcnRfZXEhKAogICAgICAgIHJlcy5tZXNzYWdlc1swXSwKICAgICAgICBDb3Ntb3NNc2c6OkJhbmsoQmFua01zZzo6U2VuZCB7CiAgICAgICAgICAgIGZyb21fYWRkcmVzczogTU9DS19DT05UUkFDVF9BRERSLmludG8oKSwKICAgICAgICAgICAgdG9fYWRkcmVzczogJnF1b3Q7Y3JlYXRvciZxdW90Oy5pbnRvKCksCiAgICAgICAgICAgIGFtb3VudCwKICAgICAgICB9KQogICAgKTsKICAgIGFzc2VydF9lcSEoCiAgICAgICAgcmVzLm1lc3NhZ2VzWzFdLAogICAgICAgIENvc21vc01zZzo6QmFuayhCYW5rTXNnOjpTZW5kIHsKICAgICAgICAgICAgZnJvbV9hZGRyZXNzOiBNT0NLX0NPTlRSQUNUX0FERFIuaW50bygpLAogICAgICAgICAgICB0b19hZGRyZXNzOiAmcXVvdDtvd25lciZxdW90Oy5pbnRvKCksCiAgICAgICAgICAgIGFtb3VudDogY29sbGF0ZXJhbCwKICAgICAgICB9KQogICAgKTsKCiAgICAvLyBjaGVjayBkZWxldGVkCiAgICBsZXQgXyA9IHF1ZXJ5X2NvbmZpZyhkZXBzLmFzX3JlZigpKS51bndyYXBfZXJyKCk7Cn0K"}}),g._v(" "),I("p",[g._v("Now run the tests:")]),g._v(" "),I("tm-code-block",{staticClass:"codeblock",attrs:{language:"shell",base64:"Y2FyZ28gdGVzdAo="}}),g._v(" "),I("p",[g._v("If all green, the code will run work on chain.")])],1)}),[],!1,null,null,null);C.default=t.exports}}]);